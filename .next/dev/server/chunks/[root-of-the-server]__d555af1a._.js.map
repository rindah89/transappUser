{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/remyngwanyam/Desktop/transapp/transapp-user-master/src/lib/supabase.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\nimport { Database } from '../types/database.types';\n\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL || process.env.SUPABASE_URL;\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY || process.env.NEXT_PUBLIC_SUPABASE_PUBLISHABLE_KEY;\nconst supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\n\nif (!supabaseUrl) {\n  throw new Error('Missing NEXT_PUBLIC_SUPABASE_URL or SUPABASE_URL environment variable');\n}\n\nif (!supabaseAnonKey && !supabaseServiceKey) {\n  throw new Error('Missing NEXT_PUBLIC_SUPABASE_ANON_KEY, NEXT_PUBLIC_SUPABASE_PUBLISHABLE_KEY, or SUPABASE_SERVICE_ROLE_KEY environment variable');\n}\n\n// Client for client-side operations (uses anon/publishable key, respects RLS)\nexport const supabase = supabaseAnonKey\n  ? createClient<Database>(supabaseUrl, supabaseAnonKey, {\n      auth: {\n        persistSession: true,\n        autoRefreshToken: true,\n        detectSessionInUrl: true\n      }\n    })\n  : null;\n\n// Client for server-side admin operations (uses service role key - REQUIRED for API routes)\n// WARNING: Only use this in API routes or getServerSideProps. NEVER expose to client.\n// Only check for service key on server side (not during client-side module evaluation)\nconst isServer = typeof window === 'undefined';\n\nif (isServer && !supabaseServiceKey) {\n  console.error('⚠️  SUPABASE_SERVICE_ROLE_KEY is missing! Server-side API routes will not work.');\n  console.error('   Get it from: Supabase Dashboard → Settings → API → service_role key');\n  console.error('   Make sure it\\'s in your .env.local file (not .env, as .env.local is not committed to git)');\n}\n\nexport const supabaseAdmin = supabaseServiceKey\n  ? createClient<Database>(supabaseUrl, supabaseServiceKey, {\n      auth: {\n        autoRefreshToken: false,\n        persistSession: false,\n        detectSessionInUrl: false\n      },\n      db: {\n        schema: 'public'\n      }\n    })\n  : (() => {\n      // Only throw error on server side when actually trying to use it\n      if (isServer) {\n        throw new Error(\n          'SUPABASE_SERVICE_ROLE_KEY is required for server-side operations.\\n' +\n          'Please add it to your .env.local file:\\n' +\n          'SUPABASE_SERVICE_ROLE_KEY=your-service-role-key-here\\n' +\n          'Get it from: Supabase Dashboard → Settings → API → service_role key'\n        );\n      }\n      // On client side, return a dummy object that will throw if used\n      return null as any;\n    })();\n"],"names":[],"mappings":";;;;;;AAAA;;AAGA,MAAM,cAAc,gFAAwC,QAAQ,GAAG,CAAC,YAAY;AACpF,MAAM,kBAAkB,QAAQ,GAAG,CAAC,6BAA6B;AACjE,MAAM,qBAAqB,QAAQ,GAAG,CAAC,yBAAyB;AAEhE;;AAIA;;AAKO,MAAM,WAAW,uCACpB,IAAA,yLAAY,EAAW,aAAa,iBAAiB;IACnD,MAAM;QACJ,gBAAgB;QAChB,kBAAkB;QAClB,oBAAoB;IACtB;AACF,KACA;AAEJ,4FAA4F;AAC5F,sFAAsF;AACtF,uFAAuF;AACvF,MAAM,WAAW,kDAAkB;AAEnC,IAAI,YAAY,CAAC,oBAAoB;IACnC,QAAQ,KAAK,CAAC;IACd,QAAQ,KAAK,CAAC;IACd,QAAQ,KAAK,CAAC;AAChB;AAEO,MAAM,gBAAgB,qBACzB,IAAA,yLAAY,EAAW,aAAa,oBAAoB;IACtD,MAAM;QACJ,kBAAkB;QAClB,gBAAgB;QAChB,oBAAoB;IACtB;IACA,IAAI;QACF,QAAQ;IACV;AACF,KACA,CAAC;IACC,iEAAiE;IACjE,wCAAc;QACZ,MAAM,IAAI,MACR,wEACA,6CACA,2DACA;IAEJ;IACA,gEAAgE;IAChE,OAAO;AACT,CAAC"}},
    {"offset": {"line": 98, "column": 0}, "map": {"version":3,"sources":["file:///Users/remyngwanyam/Desktop/transapp/transapp-user-master/src/exceptions/HttpException.ts"],"sourcesContent":["export class HttpException extends Error {\n  public status: number;\n  public message: string;\n\n  constructor(status: number, message: string) {\n    super(message);\n    this.status = status;\n    this.message = message;\n  }\n}\n"],"names":[],"mappings":";;;;AAAO,MAAM,sBAAsB;IAC1B,OAAe;IACf,QAAgB;IAEvB,YAAY,MAAc,EAAE,OAAe,CAAE;QAC3C,KAAK,CAAC;QACN,IAAI,CAAC,MAAM,GAAG;QACd,IAAI,CAAC,OAAO,GAAG;IACjB;AACF"}},
    {"offset": {"line": 115, "column": 0}, "map": {"version":3,"sources":["file:///Users/remyngwanyam/Desktop/transapp/transapp-user-master/src/services/trips.service.ts"],"sourcesContent":["import { supabaseAdmin } from '@databases/supabase';\nimport { HttpException } from '../exceptions/HttpException';\nimport type { Trip } from '../interfaces/trips.interface';\n\nclass TripService {\n  public async searchTrips(params: {\n    from?: string;\n    to?: string;\n    journeyDate?: string;\n    departureTime?: string;\n  }): Promise<Trip[]> {\n    let query = supabaseAdmin\n      .from('trips')\n      .select('*');\n\n    if (params.from) {\n      query = query.eq('from_location', params.from);\n    }\n\n    if (params.to) {\n      query = query.eq('to_location', params.to);\n    }\n\n    if (params.journeyDate) {\n      query = query.eq('journey_date', params.journeyDate);\n    }\n\n    if (params.departureTime) {\n      query = query.gte('departure', params.departureTime);\n    }\n\n    query = query.order('departure', { ascending: true });\n\n    const { data, error } = await query;\n\n    if (error) {\n      throw new HttpException(500, error.message);\n    }\n\n    return (data || []) as Trip[];\n  }\n}\n\nexport default TripService;\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAGA,MAAM;IACJ,MAAa,YAAY,MAKxB,EAAmB;QAClB,IAAI,QAAQ,yIAAa,CACtB,IAAI,CAAC,SACL,MAAM,CAAC;QAEV,IAAI,OAAO,IAAI,EAAE;YACf,QAAQ,MAAM,EAAE,CAAC,iBAAiB,OAAO,IAAI;QAC/C;QAEA,IAAI,OAAO,EAAE,EAAE;YACb,QAAQ,MAAM,EAAE,CAAC,eAAe,OAAO,EAAE;QAC3C;QAEA,IAAI,OAAO,WAAW,EAAE;YACtB,QAAQ,MAAM,EAAE,CAAC,gBAAgB,OAAO,WAAW;QACrD;QAEA,IAAI,OAAO,aAAa,EAAE;YACxB,QAAQ,MAAM,GAAG,CAAC,aAAa,OAAO,aAAa;QACrD;QAEA,QAAQ,MAAM,KAAK,CAAC,aAAa;YAAE,WAAW;QAAK;QAEnD,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM;QAE9B,IAAI,OAAO;YACT,MAAM,IAAI,qJAAa,CAAC,KAAK,MAAM,OAAO;QAC5C;QAEA,OAAQ,QAAQ,EAAE;IACpB;AACF;uCAEe"}},
    {"offset": {"line": 153, "column": 0}, "map": {"version":3,"sources":["file:///Users/remyngwanyam/Desktop/transapp/transapp-user-master/src/app/api/v1/trips/trip-search/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport TripService from '@services/trips.service';\nimport type { Trip } from '@interfaces/trips.interface';\n\nconst tripService = new TripService();\n\ninterface TripSearchResponse {\n  error: boolean;\n  message: string;\n  data?: Trip[];\n}\n\ninterface TripSearchParams {\n  from?: string;\n  to?: string;\n  journeyDate?: string;\n  departureTime?: string;\n}\n\n// Next.js 16 best practice: Use async request APIs\nexport async function GET(request: NextRequest): Promise<NextResponse<TripSearchResponse>> {\n  try {\n    \n    const searchParams = request.nextUrl.searchParams;\n    const params: TripSearchParams = {\n      from: searchParams.get('from') || undefined,\n      to: searchParams.get('to') || undefined,\n      journeyDate: searchParams.get('journeyDate') || undefined,\n      departureTime: searchParams.get('departureTime') || undefined,\n    };\n\n    const trips: Trip[] = await tripService.searchTrips(params);\n    \n    return NextResponse.json<TripSearchResponse>({\n      error: false,\n      message: 'Trips retrieved successfully',\n      data: trips,\n    }, {\n      headers: {\n        'Cache-Control': 'public, s-maxage=60, stale-while-revalidate=120',\n      },\n    });\n  } catch (error: unknown) {\n    const httpError = error as { status?: number; message?: string };\n    return NextResponse.json<TripSearchResponse>(\n      {\n        error: true,\n        message: httpError.message || 'Failed to search trips',\n      },\n      { \n        status: httpError.status || 500,\n        headers: {\n          'Cache-Control': 'no-store',\n        },\n      }\n    );\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAGA,MAAM,cAAc,IAAI,gJAAW;AAgB5B,eAAe,IAAI,OAAoB;IAC5C,IAAI;QAEF,MAAM,eAAe,QAAQ,OAAO,CAAC,YAAY;QACjD,MAAM,SAA2B;YAC/B,MAAM,aAAa,GAAG,CAAC,WAAW;YAClC,IAAI,aAAa,GAAG,CAAC,SAAS;YAC9B,aAAa,aAAa,GAAG,CAAC,kBAAkB;YAChD,eAAe,aAAa,GAAG,CAAC,oBAAoB;QACtD;QAEA,MAAM,QAAgB,MAAM,YAAY,WAAW,CAAC;QAEpD,OAAO,gJAAY,CAAC,IAAI,CAAqB;YAC3C,OAAO;YACP,SAAS;YACT,MAAM;QACR,GAAG;YACD,SAAS;gBACP,iBAAiB;YACnB;QACF;IACF,EAAE,OAAO,OAAgB;QACvB,MAAM,YAAY;QAClB,OAAO,gJAAY,CAAC,IAAI,CACtB;YACE,OAAO;YACP,SAAS,UAAU,OAAO,IAAI;QAChC,GACA;YACE,QAAQ,UAAU,MAAM,IAAI;YAC5B,SAAS;gBACP,iBAAiB;YACnB;QACF;IAEJ;AACF"}}]
}