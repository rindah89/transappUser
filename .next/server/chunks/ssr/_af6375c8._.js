module.exports=[608852,a=>{"use strict";let b={src:a.i(218677).default,width:90,height:90,blurWidth:8,blurHeight:8,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAIAAABLbSncAAAAMElEQVR42qXNuwkAIBRD0bf/WkHywaEUOxEbPe0NpPpFvQZJtkkm2UJbAMzF58dpAJnnmIYPWUN+AAAAAElFTkSuQmCC"};a.s(["default",0,b])},181549,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(127669),f=a.i(327711),g=a.i(865830),h=a.i(261482),i=a.i(23150),j=a.i(76189),k=a.i(227073),l=a.i(480868),m=a.i(475627),n=a.i(547750),o=a.i(820864),p=a.i(653160),q=a.i(328646),r=a.i(906197),s=a.i(812967),t=a.i(926653),u=a.i(25670),v=a.i(691098),w=a.i(239890),x=a.i(943431),y=a.i(711210),z=a.i(138609),A=a.i(734637),B=b([m,n,r,s]);[m,n,r,s]=B.then?(await B)():B,a.s(["default",0,({modal:a,getModal:b,booking:c,buttonText:B="Pay Now"})=>{let{t:C}=(0,n.useTranslation)();(0,u.useRouter)();let{register:D,reset:E,getValues:F,setValue:G,watch:H,handleSubmit:I,formState:{errors:J}}=(0,r.useForm)(),[K,L]=(0,e.useState)(!1),{state:M}=(0,o.useStateMachine)({updateBooking:p.updateBooking,updateAction:p.updateAction,updateUser:p.updateUser}),N=M?.trip?.trip??M?.trip,O=new q.default({length:10,dictionary:"alphanum_upper"}).rnd();(0,e.useEffect)(()=>{c&&E({data:c})},[c,E]);let P=async()=>{if(L(!0),F("phoneNumber"),F("name"),F("idCardNo"),F("payerEmail"),!F("seat")){m.toast.error(C("seat_required")||"Please select a seat"),L(!1);return}let a={total_amount:N?.price||100,currency:"XAF",transaction_id:O,return_url:"http://localhost:3000/payunit-return/:transaction_id/:transaction_amount/:transaction_gateway/:transaction_status/:purchaseRef/:currency"};try{let{data:b}=await s.default.post("api/v1/payunit/initialize",a);b?.error&&(m.toast.error(b.message),L(!1))}catch(a){if(s.default.isAxiosError(a)){let b=a.response?.data?.message||"Payment initialization failed";m.toast.error(b)}else m.toast.error("An unexpected error occurred");L(!1)}},[Q,R]=(0,e.useState)([]),[S,T]=(0,e.useState)(!1),U=(0,e.useMemo)(()=>{let a=Number(N?.seats);return Number.isFinite(a)&&a>0?a:0},[N?.seats]);(0,e.useEffect)(()=>{(async()=>{if(a.modal_static&&N?.id){T(!0);try{let{data:a}=await s.default.get(`api/v1/bookings/trip-seats/${N.id}`);a?.error?R([]):R(a?.data?.takenSeats||[])}catch{R([])}finally{T(!1)}}})()},[a.modal_static,N?.id]);let V=H("seat"),W=(0,e.useMemo)(()=>{if(U<=0)return[];let a=Array.from({length:U},(a,b)=>String(b+1)),b=[];for(let c=0;c<a.length;c+=4)b.push({left:[a[c]??null,a[c+1]??null],right:[a[c+2]??null,a[c+3]??null]});return b},[U]),X=({seat:a})=>{if(!a)return(0,d.jsx)("div",{className:"ta-seat ta-seat--empty","aria-hidden":"true"});let b=Q.includes(a),c=V===a;return(0,d.jsx)("button",{type:"button",className:`ta-seat ${b?"is-taken":"is-available"} ${c?"is-selected":""}`,disabled:b,onClick:()=>{G("seat",a,{shouldValidate:!0,shouldDirty:!0})},"aria-label":`Seat ${a}${b?" (taken)":c?" (selected)":""}`,children:a},a)};return(0,d.jsx)(d.Fragment,{children:(0,d.jsxs)(h.Modal,{isOpen:a.modal_static,backdrop:"static",centered:!0,size:"lg",contentClassName:"ta-modal",children:[(0,d.jsx)(i.ModalHeader,{className:"ta-modal__header",children:(0,d.jsxs)("div",{className:"ta-modal__headerInner",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:"ta-modal__kicker",children:C("booking_details")||"Booking details"}),(0,d.jsxs)("div",{className:"ta-modal__title",children:[(0,d.jsx)(x.MapPin,{size:18}),(0,d.jsx)("span",{children:N?.from_location||"-"}),(0,d.jsx)("span",{className:"ta-modal__arrow",children:"→"}),(0,d.jsx)("span",{children:N?.to_location||"-"})]})]}),(0,d.jsx)("button",{type:"button",className:"ta-modal__close",onClick:()=>b({modal_static:!1}),"aria-label":C("close")||"Close",children:(0,d.jsx)(A.X,{size:18})})]})}),(0,d.jsx)(j.ModalBody,{children:(0,d.jsxs)("form",{onSubmit:I(P),children:[(0,d.jsxs)(f.Row,{children:[(0,d.jsxs)(g.Col,{lg:6,children:[(0,d.jsxs)("div",{className:"ta-field",children:[(0,d.jsx)("label",{htmlFor:"name",className:"ta-field__label",children:C("name")}),(0,d.jsxs)("div",{className:"ta-field__control",children:[(0,d.jsx)("span",{className:"ta-field__icon","aria-hidden":"true",children:(0,d.jsx)(z.User,{size:16})}),(0,d.jsx)("input",{type:"text",id:"name",className:"form-control ta-input",...D("name",{required:!0,minLength:2})})]})]}),J.name&&(0,d.jsx)("p",{style:{color:"red"},children:C("agency_branch_err")})]}),(0,d.jsxs)(g.Col,{lg:6,children:[(0,d.jsxs)("div",{className:"ta-field",children:[(0,d.jsx)("label",{htmlFor:"idCardNo",className:"ta-field__label",children:C("id_card")}),(0,d.jsxs)("div",{className:"ta-field__control",children:[(0,d.jsx)("span",{className:"ta-field__icon","aria-hidden":"true",children:(0,d.jsx)(v.CreditCard,{size:16})}),(0,d.jsx)("input",{type:"text",id:"idCardNo",className:"form-control ta-input",...D("idCardNo",{required:!0})})]})]}),J.idCardNo&&(0,d.jsx)("p",{style:{color:"red"},children:C("id_card_err")})]}),(0,d.jsxs)(g.Col,{lg:6,children:[(0,d.jsxs)("div",{className:"ta-field",children:[(0,d.jsx)("label",{htmlFor:"phoneNumber",className:"ta-field__label",children:C("phone")}),(0,d.jsxs)("div",{className:"ta-field__control",children:[(0,d.jsx)("span",{className:"ta-field__icon","aria-hidden":"true",children:(0,d.jsx)(y.Phone,{size:16})}),(0,d.jsx)("input",{type:"tel",inputMode:"numeric",id:"phoneNumber",placeholder:C("valid_momo_number")||"Valid money transfer number",className:"form-control ta-input",...D("phoneNumber",{required:!0,minLength:9,maxLength:12})})]})]}),J.phoneNumber&&(0,d.jsx)("p",{style:{color:"red"},children:C("phone_err")})]}),(0,d.jsxs)(g.Col,{lg:6,children:[(0,d.jsxs)("div",{className:"ta-field",children:[(0,d.jsx)("label",{htmlFor:"payerEmail",className:"ta-field__label",children:C("email_address")}),(0,d.jsxs)("div",{className:"ta-field__control",children:[(0,d.jsx)("span",{className:"ta-field__icon","aria-hidden":"true",children:(0,d.jsx)(w.Mail,{size:16})}),(0,d.jsx)("input",{type:"email",id:"payerEmail",className:"form-control ta-input",...D("payerEmail",{required:!0})})]})]}),J.payerEmail&&(0,d.jsx)("p",{style:{color:"red"},children:C("phone_err")})]})]}),(0,d.jsxs)("div",{className:"ta-seatmap mt-3",children:[(0,d.jsxs)("div",{className:"ta-seatmap__header",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:"ta-seatmap__title",children:C("seat")||"Seat"}),(0,d.jsx)("div",{className:"ta-seatmap__subtitle",children:S?C("loading")||"Loading...":C("select_seat")||"Select your seat"})]}),(0,d.jsxs)("div",{className:"ta-seatmap__legend",children:[(0,d.jsx)("span",{className:"ta-legend is-available",children:C("available")||"Available"}),(0,d.jsx)("span",{className:"ta-legend is-selected",children:C("selected")||"Selected"}),(0,d.jsx)("span",{className:"ta-legend is-taken",children:C("taken")||"Taken"})]})]}),(0,d.jsx)("input",{type:"hidden",...D("seat",{required:!0})}),J.seat?(0,d.jsx)("div",{className:"text-danger mt-1",children:C("seat_required")||"Please select a seat"}):null,U>0?(0,d.jsxs)("div",{className:"ta-seatmap__bus",role:"group","aria-label":C("seat_map")||"Seat map",children:[(0,d.jsx)("div",{className:"ta-seatmap__driver","aria-hidden":"true",children:C("driver")||"Driver"}),(0,d.jsx)("div",{className:"ta-seatmap__rows",children:W.map((a,b)=>(0,d.jsxs)("div",{className:"ta-seatmap__row",children:[(0,d.jsxs)("div",{className:"ta-seatmap__side",children:[(0,d.jsx)(X,{seat:a.left[0]}),(0,d.jsx)(X,{seat:a.left[1]})]}),(0,d.jsx)("div",{className:"ta-seatmap__aisle","aria-hidden":"true"}),(0,d.jsxs)("div",{className:"ta-seatmap__side",children:[(0,d.jsx)(X,{seat:a.right[0]}),(0,d.jsx)(X,{seat:a.right[1]})]})]},b))})]}):(0,d.jsx)("div",{className:"text-muted",children:C("no_seat_map")||"Seat map not available for this trip"})]}),(0,d.jsx)(k.ModalFooter,{children:K?(0,d.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",padding:"20px"},children:(0,d.jsx)(t.SpinnerCircular,{color:"#bcc015",size:50,"aria-label":"Loading Spinner","data-testid":"loader"})}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(l.Button,{color:"light",onClick:()=>b({modal_static:!1}),children:C("cancel")}),(0,d.jsx)(l.Button,{type:"submit",color:"primary",children:B})]})})]})})]})})}]),c()}catch(a){c(a)}},!1),182738,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(127669),f=a.i(820864),g=a.i(653160),h=a.i(613903),i=a.i(327711),j=a.i(865830),k=a.i(673453),l=a.i(237502),m=a.i(480868),n=a.i(261482),o=a.i(23150),p=a.i(76189),q=a.i(227073),r=a.i(260607),s=a.i(812967),t=a.i(926653),u=a.i(938263),v=a.i(608852),w=a.i(547750),x=a.i(475627),y=a.i(181549),z=a.i(901257),A=a.i(761894),B=a.i(679069),C=a.i(385150),D=a.i(654714),E=b([s,w,x,y,A,B]);[s,w,x,y,A,B]=E.then?(await E)():E,a.s(["default",0,()=>{let{t:a}=(0,w.useTranslation)(),[b,c]=(0,e.useState)(!1),[E,F]=(0,e.useState)(!1),[G,H]=(0,e.useState)(""),[I,J]=(0,e.useState)(null),{actions:K,state:L}=(0,f.useStateMachine)({updateSearch:g.updateSearch,updateAction:g.updateAction}),[M,N]=(0,e.useState)([]),[O,P]=(0,e.useState)(!0),[Q,R]=(0,e.useState)(null),[S,T]=(0,e.useState)(D.DEFAULT_TRIP_FILTERS),U=(0,e.useRef)(null),[V,W]=(0,e.useState)({modal_static:!1}),[X,Y]=(0,e.useState)({modal_static:!1}),[Z,$]=(0,e.useState)({modal_static:!1}),_=L?.search,aa="string"==typeof _?.journeyDate?_.journeyDate:_?.journeyDate?(0,r.default)(_.journeyDate).format("YYYY-MM-DD"):"",ab="string"==typeof _?.from?_.from:_?.from?.value||"",ac="string"==typeof _?.to?_.to:_?.to?.value||"",ad="string"==typeof _?.departureTime?_.departureTime:_?.departureTime?(0,r.default)(_.departureTime).format("HH:mm"):"",ae=_?.journeyDate?(0,r.default)(_.journeyDate).toDate():void 0,af=_?.departureTime?(0,r.default)(_.departureTime,["HH:mm","hh:mm A"]).toDate():void 0;function ag(){c(!1),$({modal_static:!1})}let ah=()=>{F(!1),Y({modal_static:!1}),H(""),J(null)},ai=(0,e.useCallback)(async()=>{try{R(null),P(!0);let{data:a}=await s.default.get("api/v1/trips/trip-search",{params:{from:ab,to:ac,journeyDate:aa,departureTime:ad}});if(a?.error)R(a.message||"Failed to fetch trips"),x.toast.error(a.message);else{let b=a.data??[];N(b)}}catch(a){if(s.default.isAxiosError(a)){let b=a.response?.data?.message||a.message||"Failed to fetch trips";R(b),x.toast.error(b)}else R("An unexpected error occurred"),x.toast.error("An unexpected error occurred")}finally{P(!1)}},[ab,ac,aa,ad]);(0,e.useEffect)(()=>{"undefined"!=typeof document&&document.body.setAttribute("style","background: #f1f5f7!important;"),ai()},[ai]);let aj=M.filter(a=>a.reserved!==a.seats),ak=(0,D.sortTrips)((0,D.applyTripFilters)(aj,S),S.sort),al=aj.length>0,am=ak.length>0;return O?(0,d.jsx)(e.default.Fragment,{children:(0,d.jsx)("div",{className:"page-content",children:(0,d.jsx)(l.Container,{fluid:!0,className:"",children:(0,d.jsx)("div",{className:"loader-outer",children:(0,d.jsx)("div",{className:"loader-inner",children:(0,d.jsx)(t.SpinnerCircular,{color:"#bcc014",size:50})})})})})}):(0,d.jsx)(d.Fragment,{children:(0,d.jsx)("section",{className:"trip-search mb-5",children:(0,d.jsxs)("div",{className:"container",children:[!O&&(Q||!al)&&(0,d.jsx)("div",{className:"row pt-5 mb-4",children:(0,d.jsx)("div",{className:"col-lg-12",children:(0,d.jsx)(h.Card,{children:(0,d.jsxs)(k.CardBody,{children:[Q?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("h4",{className:"mb-2",children:[a("Failed")," / ",a("error")||"Error"]}),(0,d.jsx)("p",{className:"mb-3",children:Q})]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("h4",{className:"mb-2",children:a("no_bus")||"No buses found"}),(0,d.jsxs)("p",{className:"mb-3",children:[a("no_bus")||"No buses were found for your search."," ",ab&&ac?(0,d.jsxs)(d.Fragment,{children:["(",ab," → ",ac,")"]}):null]})]}),(0,d.jsx)("div",{className:"d-flex gap-2 flex-wrap",children:(0,d.jsx)(m.Button,{color:"primary",onClick:()=>ai(),children:a("retry")||"Retry"})}),(0,d.jsxs)("div",{className:"mt-4",children:[(0,d.jsx)("h6",{className:"mb-3",children:a("modify_search")||"Modify search"}),(0,d.jsx)(A.default,{text:"book",initialFrom:ab||void 0,initialTo:ac||void 0,initialJourneyDate:ae,initialDepartureTime:af}),(0,d.jsx)("div",{className:"mt-4",children:(0,d.jsx)(B.default,{})}),(0,d.jsx)("div",{className:"mt-3",children:(0,d.jsx)(z.default,{href:"/book",className:"btn btn-outline-secondary",children:a("back")||"Back"})})]})]})})})}),(0,d.jsx)("div",{className:"row pt-5 mb-4",children:(0,d.jsx)("div",{className:"col-lg-12",children:al?(0,d.jsxs)("h6",{children:[am?ak.length:0," ",a("buses")," ",a("from")," ",ab," ",a("to")," ",ac]}):(0,d.jsxs)("h6",{children:[aj.length," ",a("no_bus")," ",a("from")," ",ab," ",a("to")," ",ac]})})}),al&&(0,d.jsx)(C.default,{trips:aj,filters:S,onChange:T}),(0,d.jsx)("div",{className:"row",children:(0,d.jsxs)("div",{className:"col-lg-12",children:[!am&&al?(0,d.jsx)(h.Card,{children:(0,d.jsxs)(k.CardBody,{children:[(0,d.jsx)("h5",{className:"mb-2",children:"No trips match your filters"}),(0,d.jsx)("p",{className:"mb-0 text-muted",children:"Try widening your price/time window or resetting filters."})]})}):null,ak.map(b=>(0,d.jsx)(h.Card,{className:"ta-trip-card",children:(0,d.jsxs)(k.CardBody,{className:"ta-trip-card__body",children:[(0,d.jsxs)("div",{className:"ta-trip-card__left",children:[(0,d.jsx)("div",{className:"ta-trip-card__logo",children:b.agency_logo?(0,d.jsx)(u.default,{src:b.agency_logo,alt:"agency logo",width:44,height:44}):(0,d.jsx)(u.default,{src:v.default,alt:"logo",width:44,height:44})}),(0,d.jsxs)("div",{className:"ta-trip-card__meta",children:[(0,d.jsxs)("div",{className:"ta-trip-card__top",children:[(0,d.jsx)("div",{className:"ta-trip-card__agency",children:b.agency_name}),(0,d.jsx)("span",{className:"badge rounded-pill text-bg-light",children:b.trip_type||"Standard"})]}),(0,d.jsxs)("div",{className:"ta-trip-card__route",children:[(0,d.jsx)("strong",{children:b.from_location})," ",(0,d.jsx)("span",{className:"text-muted",children:"→"})," ",(0,d.jsx)("strong",{children:b.to_location})]}),(0,d.jsxs)("div",{className:"ta-trip-card__sub",children:[(0,d.jsxs)("span",{children:[a("departure"),": ",String(b.departure||"")]}),(0,d.jsx)("span",{className:"ta-dot",children:"•"}),(0,d.jsxs)("span",{children:[a("available_seats"),": ",(0,D.availableSeats)(b)]})]})]})]}),(0,d.jsxs)("div",{className:"ta-trip-card__right",children:[(0,d.jsxs)("div",{className:"ta-trip-card__price",children:[(0,d.jsx)("div",{className:"ta-trip-card__price-label",children:a("price")}),(0,d.jsxs)("div",{className:"ta-trip-card__price-value",children:[b.price," XAF"]})]}),b.reserved!==b.seats?(0,d.jsx)(m.Button,{color:"primary",className:"ta-btn-primary",onClick:()=>{U.current=b,K.updateAction({trip:U.current}),W({modal_static:!0})},children:a("get_ticket")}):(0,d.jsx)(m.Button,{disabled:!0,className:"ta-btn-primary",children:a("sold_out")||"Sold Out"})]})]})},b.id))]})}),(0,d.jsx)(y.default,{getModal:W,modal:V,booking:U.current||void 0,buttonText:a("buy")}),E&&(0,d.jsxs)(n.Modal,{isOpen:X.modal_static,toggle:ah,centered:!0,size:"sm",children:[(0,d.jsxs)(o.ModalHeader,{toggle:ah,children:[a("Success"),"!"]}),(0,d.jsx)(p.ModalBody,{children:(0,d.jsx)(i.Row,{children:(0,d.jsxs)(j.Col,{lg:12,children:[(0,d.jsxs)("p",{className:"text-center",children:[a("ticket_num")," ",G]}),(0,d.jsxs)("p",{className:"text-center",children:[a("seat"),": ",I]})]})})}),(0,d.jsx)(q.ModalFooter,{children:(0,d.jsx)(m.Button,{color:"primary",onClick:ah,children:"OK"})})]}),b&&(0,d.jsxs)(n.Modal,{isOpen:Z.modal_static,toggle:ag,centered:!0,size:"sm",children:[(0,d.jsxs)(o.ModalHeader,{toggle:ag,children:[a("Failed"),"!"]}),(0,d.jsx)(p.ModalBody,{children:(0,d.jsx)(i.Row,{children:(0,d.jsx)(j.Col,{lg:12,children:(0,d.jsx)("p",{className:"text-center",children:a("failed_booking")})})})}),(0,d.jsx)(q.ModalFooter,{children:(0,d.jsx)(m.Button,{color:"primary",onClick:ag,children:"OK"})})]})]})})})}]),c()}catch(a){c(a)}},!1),993487,a=>a.a(async(b,c)=>{try{var d=a.i(579168),e=a.i(627068),f=a.i(332759),g=a.i(539141),h=a.i(468695),i=a.i(182738),j=a.i(509193),k=b([h,i]);[h,i]=k.then?(await k)():k;let l=(0,f.hoist)(i,"default"),m=(0,f.hoist)(i,"getStaticProps"),n=(0,f.hoist)(i,"getStaticPaths"),o=(0,f.hoist)(i,"getServerSideProps"),p=(0,f.hoist)(i,"config"),q=(0,f.hoist)(i,"reportWebVitals"),r=(0,f.hoist)(i,"unstable_getStaticProps"),s=(0,f.hoist)(i,"unstable_getStaticPaths"),t=(0,f.hoist)(i,"unstable_getStaticParams"),u=(0,f.hoist)(i,"unstable_getServerProps"),v=(0,f.hoist)(i,"unstable_getServerSideProps"),w=new d.PagesRouteModule({definition:{kind:e.RouteKind.PAGES,page:"/Users/TripSearch",pathname:"/Users/TripSearch",bundlePath:"",filename:""},distDir:".next",relativeProjectDir:"",components:{App:h.default,Document:g.default},userland:i}),x=(0,j.getHandler)({srcPage:"/Users/TripSearch",config:p,userland:i,routeModule:w,getStaticPaths:n,getStaticProps:m,getServerSideProps:o});a.s(["config",0,p,"default",0,l,"getServerSideProps",0,o,"getStaticPaths",0,n,"getStaticProps",0,m,"handler",0,x,"reportWebVitals",0,q,"routeModule",0,w,"unstable_getServerProps",0,u,"unstable_getServerSideProps",0,v,"unstable_getStaticParams",0,t,"unstable_getStaticPaths",0,s,"unstable_getStaticProps",0,r]),c()}catch(a){c(a)}},!1)];

//# sourceMappingURL=_af6375c8._.js.map