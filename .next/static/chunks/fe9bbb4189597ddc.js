(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,753528,(t,e,i)=>{"use strict";var a=(()=>{var t=Object.defineProperty,e=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,a=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,n=(e,i,a)=>i in e?t(e,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[i]=a,o=(t,e)=>{for(var i in e||(e={}))r.call(e,i)&&n(t,i,e[i]);if(a)for(var i of a(e))s.call(e,i)&&n(t,i,e[i]);return t},l=(t,e,i)=>n(t,"symbol"!=typeof e?e+"":e,i),h={},d={DEFAULT_OPTIONS:()=>_,DEFAULT_UUID_LENGTH:()=>u,default:()=>g};for(var c in d)t(h,c,{get:d[c],enumerable:!0});var u=6,_={dictionary:"alphanum",shuffle:!0,debug:!1,length:6,counter:0},p=class{constructor(t={}){var e=this;l(this,"counter"),l(this,"debug"),l(this,"dict"),l(this,"version"),l(this,"dictIndex",0),l(this,"dictRange",[]),l(this,"lowerBound",0),l(this,"upperBound",0),l(this,"dictLength",0),l(this,"uuidLength"),l(this,"_digit_first_ascii",48),l(this,"_digit_last_ascii",58),l(this,"_alpha_lower_first_ascii",97),l(this,"_alpha_lower_last_ascii",123),l(this,"_hex_last_ascii",103),l(this,"_alpha_upper_first_ascii",65),l(this,"_alpha_upper_last_ascii",91),l(this,"_number_dict_ranges",{digits:[this._digit_first_ascii,this._digit_last_ascii]}),l(this,"_alpha_dict_ranges",{lowerCase:[this._alpha_lower_first_ascii,this._alpha_lower_last_ascii],upperCase:[this._alpha_upper_first_ascii,this._alpha_upper_last_ascii]}),l(this,"_alpha_lower_dict_ranges",{lowerCase:[this._alpha_lower_first_ascii,this._alpha_lower_last_ascii]}),l(this,"_alpha_upper_dict_ranges",{upperCase:[this._alpha_upper_first_ascii,this._alpha_upper_last_ascii]}),l(this,"_alphanum_dict_ranges",{digits:[this._digit_first_ascii,this._digit_last_ascii],lowerCase:[this._alpha_lower_first_ascii,this._alpha_lower_last_ascii],upperCase:[this._alpha_upper_first_ascii,this._alpha_upper_last_ascii]}),l(this,"_alphanum_lower_dict_ranges",{digits:[this._digit_first_ascii,this._digit_last_ascii],lowerCase:[this._alpha_lower_first_ascii,this._alpha_lower_last_ascii]}),l(this,"_alphanum_upper_dict_ranges",{digits:[this._digit_first_ascii,this._digit_last_ascii],upperCase:[this._alpha_upper_first_ascii,this._alpha_upper_last_ascii]}),l(this,"_hex_dict_ranges",{decDigits:[this._digit_first_ascii,this._digit_last_ascii],alphaDigits:[this._alpha_lower_first_ascii,this._hex_last_ascii]}),l(this,"_dict_ranges",{_number_dict_ranges:this._number_dict_ranges,_alpha_dict_ranges:this._alpha_dict_ranges,_alpha_lower_dict_ranges:this._alpha_lower_dict_ranges,_alpha_upper_dict_ranges:this._alpha_upper_dict_ranges,_alphanum_dict_ranges:this._alphanum_dict_ranges,_alphanum_lower_dict_ranges:this._alphanum_lower_dict_ranges,_alphanum_upper_dict_ranges:this._alphanum_upper_dict_ranges,_hex_dict_ranges:this._hex_dict_ranges}),l(this,"log",function(){for(var t=arguments.length,i=Array(t),a=0;a<t;a++)i[a]=arguments[a];let r=[...i];if(r[0]="[short-unique-id] ".concat(i[0]),!0===e.debug&&"undefined"!=typeof console&&null!==console)return void console.log(...r)}),l(this,"_normalizeDictionary",(t,e)=>{let i;if(t&&Array.isArray(t)&&t.length>1)i=t;else{i=[],this.dictIndex=0;let e="_".concat(t,"_dict_ranges"),a=this._dict_ranges[e],r=0;for(let[,t]of Object.entries(a)){let[e,i]=t;r+=Math.abs(i-e)}i=Array(r);let s=0;for(let[,t]of Object.entries(a)){this.dictRange=t,this.lowerBound=this.dictRange[0],this.upperBound=this.dictRange[1];let e=this.lowerBound<=this.upperBound,a=this.lowerBound,r=this.upperBound;if(e)for(let t=a;t<r;t++)i[s++]=String.fromCharCode(t),this.dictIndex=t;else for(let t=a;t>r;t--)i[s++]=String.fromCharCode(t),this.dictIndex=t}i.length=s}if(e){let t=i.length;for(let e=t-1;e>0;e--){let t=Math.floor(Math.random()*(e+1));[i[e],i[t]]=[i[t],i[e]]}}return i}),l(this,"setDictionary",(t,e)=>{this.dict=this._normalizeDictionary(t,e),this.dictLength=this.dict.length,this.setCounter(0)}),l(this,"seq",()=>this.sequentialUUID()),l(this,"sequentialUUID",()=>{let t=this.dictLength,e=this.dict,i=this.counter,a=[];do{let r=i%t;i=Math.trunc(i/t),a.push(e[r])}while(0!==i)let r=a.join("");return this.counter+=1,r}),l(this,"rnd",function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.uuidLength||u;return e.randomUUID(t)}),l(this,"randomUUID",function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.uuidLength||u;if(null==t||t<1)throw Error("Invalid UUID Length Provided");let i=Array(t),a=e.dictLength,r=e.dict;for(let e=0;e<t;e++){let t=Math.floor(Math.random()*a);i[e]=r[t]}return i.join("")}),l(this,"fmt",(t,e)=>this.formattedUUID(t,e)),l(this,"formattedUUID",(t,e)=>{let i={$r:this.randomUUID,$s:this.sequentialUUID,$t:this.stamp};return t.replace(/\$[rs]\d{0,}|\$t0|\$t[1-9]\d{1,}/g,t=>{let a=t.slice(0,2),r=Number.parseInt(t.slice(2),10);return"$s"===a?i[a]().padStart(r,"0"):"$t"===a&&e?i[a](r,e):i[a](r)})}),l(this,"availableUUIDs",function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.uuidLength;return Number.parseFloat(([...new Set(e.dict)].length**t).toFixed(0))}),l(this,"_collisionCache",new Map),l(this,"approxMaxBeforeCollision",function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.availableUUIDs(e.uuidLength),i=e._collisionCache.get(t);if(void 0!==i)return i;let a=Number.parseFloat(Math.sqrt(Math.PI/2*t).toFixed(20));return e._collisionCache.set(t,a),a}),l(this,"collisionProbability",function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.availableUUIDs(e.uuidLength),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.uuidLength;return Number.parseFloat((e.approxMaxBeforeCollision(t)/e.availableUUIDs(i)).toFixed(20))}),l(this,"uniqueness",function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.availableUUIDs(e.uuidLength),i=Number.parseFloat((1-e.approxMaxBeforeCollision(t)/t).toFixed(20));return i>1?1:i<0?0:i}),l(this,"getVersion",()=>this.version),l(this,"stamp",(t,e)=>{let i=Math.floor((e||new Date)/1e3).toString(16);if("number"==typeof t&&0===t)return i;if("number"!=typeof t||t<10)throw Error("Param finalLength must be a number greater than or equal to 10,\nor 0 if you want the raw hexadecimal timestamp");let a=t-9,r=Math.round(Math.random()*(a>15?15:a)),s=this.randomUUID(a);return"".concat(s.substring(0,r)).concat(i).concat(s.substring(r)).concat(r.toString(16))}),l(this,"parseStamp",(t,e)=>{if(e&&!/t0|t[1-9]\d{1,}/.test(e))throw Error("Cannot extract date from a formated UUID with no timestamp in the format");let i=e?e.replace(/\$[rs]\d{0,}|\$t0|\$t[1-9]\d{1,}/g,t=>({$r:t=>[...Array(t)].map(()=>"r").join(""),$s:t=>[...Array(t)].map(()=>"s").join(""),$t:t=>[...Array(t)].map(()=>"t").join("")})[t.slice(0,2)](Number.parseInt(t.slice(2),10))).replace(/^(.*?)(t{8,})(.*)$/g,(e,i,a)=>t.substring(i.length,i.length+a.length)):t;if(8===i.length)return new Date(1e3*Number.parseInt(i,16));if(i.length<10)throw Error("Stamp length invalid");let a=Number.parseInt(i.substring(i.length-1),16);return new Date(1e3*Number.parseInt(i.substring(a,a+8),16))}),l(this,"setCounter",t=>{this.counter=t}),l(this,"validate",(t,e)=>{let i=e?this._normalizeDictionary(e):this.dict;return t.split("").every(t=>i.includes(t))});const i=o(o({},_),t);this.counter=0,this.debug=!1,this.dict=[],this.version="5.3.2";const{dictionary:a,shuffle:r,length:s,counter:n}=i;this.uuidLength=s,this.setDictionary(a,r),this.setCounter(n),this.debug=i.debug,this.log(this.dict),this.log("Generator instantiated with Dictionary Size ".concat(this.dictLength," and counter set to ").concat(this.counter)),this.log=this.log.bind(this),this.setDictionary=this.setDictionary.bind(this),this.setCounter=this.setCounter.bind(this),this.seq=this.seq.bind(this),this.sequentialUUID=this.sequentialUUID.bind(this),this.rnd=this.rnd.bind(this),this.randomUUID=this.randomUUID.bind(this),this.fmt=this.fmt.bind(this),this.formattedUUID=this.formattedUUID.bind(this),this.availableUUIDs=this.availableUUIDs.bind(this),this.approxMaxBeforeCollision=this.approxMaxBeforeCollision.bind(this),this.collisionProbability=this.collisionProbability.bind(this),this.uniqueness=this.uniqueness.bind(this),this.getVersion=this.getVersion.bind(this),this.stamp=this.stamp.bind(this),this.parseStamp=this.parseStamp.bind(this)}};l(p,"default",p);var g=p;return((a,s,n,o)=>{if(s&&"object"==typeof s||"function"==typeof s)for(let l of i(s))r.call(a,l)||l===n||t(a,l,{get:()=>s[l],enumerable:!(o=e(s,l))||o.enumerable});return a})(t({},"__esModule",{value:!0}),h)})();e.exports=a.default,"undefined"!=typeof window&&(a=a.default)},270133,t=>{"use strict";var e=t.i(247167),i=t.i(467034),a=t.i(843476),r=t.i(271645),s=t.i(307573),n=t.i(901381),o=t.i(434423),l=t.i(378158),h=t.i(392094),d=t.i(518102),c=t.i(627179),u=t.i(904794),_=t.i(530671),p=t.i(652353),g=t.i(166540),m=t.i(581949),f=t.i(753528),b=t.i(109327);t.i(785269);var y=t.i(322831),v=t.i(618566),x=t.i(705766);let w=new Date().getFullYear();t.s(["default",0,()=>{var t;let{t:U}=(0,y.useTranslation)(),j=(0,v.useRouter)(),I=localStorage.getItem("transactionID"),[D,S]=(0,r.useState)(!1),[C,N]=(0,r.useState)(!1),[M,k]=(0,r.useState)(""),[B,A]=(0,r.useState)(null),{state:L}=(0,s.useStateMachine)({updateSearch:n.updateSearch,updateAction:n.updateAction}),[O,F]=(0,r.useState)(!0),P="".concat("4d70631d-397c-4efd-929a-87fcd3a9d162",":").concat("2a8f415d-d9d2-4834-a573-b12c1375b94c"),q=void 0!==i.Buffer?i.Buffer.from(P).toString("base64"):btoa(P),[E,$]=(0,r.useState)({modal_static:!1}),[T,R]=(0,r.useState)({modal_static:!1});function z(){S(!1),R({modal_static:!1})}let K=()=>{N(!1),$({modal_static:!1}),j.replace("/book")},H=async()=>{var t,i,a;if(!I)return null;let r={headers:{"x-api-key":e.default.env.NEXT_PUBLIC_PAYUNIT_API_KEY||"sand_oCYvry8nlC13jE8vg8om99clqyHBAe",mode:"test","Content-Type":"application/json",Authorization:"Basic "+q}};try{let{data:e}=await m.default.get("https://app.payunit.net/api/gateway/paymentstatus/".concat(I),r);if(null==e?void 0:e.error)return x.toast.error(e.message),null;return(null==(t=e.data)?void 0:t.transaction_status)||null}catch(t){return F(!1),m.default.isAxiosError(t)?x.toast.error((null==(a=t.response)||null==(i=a.data)?void 0:i.message)||"Failed to check payment status"):x.toast.error("An unexpected error occurred"),null}},Y=async()=>{var t,e,i,a,r,s;let n=localStorage.getItem("phone"),o=localStorage.getItem("name"),l=localStorage.getItem("idCard"),h=localStorage.getItem("email"),d=null==(t=null==L?void 0:L.trip)?void 0:t.trip;if(!d)return void x.toast.error("No trip selected");let c=new f.default({length:7,dictionary:"alphanum_upper"}),u={phone_number:n?Number(n):null,number_of_seats:"1",ticket_type:"One-way",transaction_id:I||null,month:new Date(d.journey_date||d.journeyDate).toLocaleString("default",{month:"short"}),year:w.toString(),week:(0,g.default)(d.journey_date||d.journeyDate).format("W"),name:o||"",id_card_no:l||null,payer_email:h||null,trip_id:d.id,agency_name:d.agency_name||d.agencyName,journey_date:d.journey_date||d.journeyDate,price:d.price,departure_city:d.from_location||d.from,arrival_city:d.to_location||d.to,departure_time:d.departure||d.departure_time,ticket_number:c.rnd(),seat:null,status:""};try{if(null==(a=null==L?void 0:L.user)||null==(i=a.data)||null==(e=i.data)?void 0:e.email){let{data:t}=await m.default.post("api/v1/bookings/create-booking/".concat(d.id),u);(null==t?void 0:t.error)?(x.toast.error(t.message),F(!1)):t.data&&(N(!0),A(t.data.seat),k(t.data.ticket_number||t.data.ticketNumber),localStorage.removeItem("phone"),localStorage.removeItem("name"),localStorage.removeItem("idCard"),localStorage.removeItem("email"),F(!1))}else{let{data:t}=await m.default.post("api/v1/bookings/anon-booking/".concat(d.id),u);(null==t?void 0:t.error)?(x.toast.error(t.message),F(!1)):t.data&&(N(!0),A(t.data.seat),k(t.data.ticket_number||t.data.ticketNumber),localStorage.removeItem("phone"),localStorage.removeItem("name"),localStorage.removeItem("idCard"),localStorage.removeItem("email"),F(!1))}}catch(t){F(!1),S(!0),m.default.isAxiosError(t)?x.toast.error((null==(s=t.response)||null==(r=s.data)?void 0:r.message)||"Failed to create booking"):x.toast.error("An unexpected error occurred")}};(0,r.useEffect)(()=>{I?(F(!0),(async()=>{let t=t=>new Promise(e=>setTimeout(e,t)),e=!0,i="";do(i=await H())&&"pending"!==i.toLowerCase()&&(e=!1),await t(3e4);while(e)"SUCCESS"===i?Y():(x.toast.error("Failed to process payment"),F(!1))})()):F(!1)},[I]);let V=null==(t=null==L?void 0:L.trip)?void 0:t.trip;return O?(0,a.jsx)(r.default.Fragment,{children:(0,a.jsx)("div",{className:"page-content",children:(0,a.jsx)(h.Container,{fluid:!0,className:"",children:(0,a.jsx)("div",{className:"loader-outer",children:(0,a.jsx)("div",{className:"loader-inner",children:(0,a.jsx)(b.SpinnerCircular,{color:"#bcc014",size:30})})})})})}):(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("section",{className:"trip-search mb-5",children:(0,a.jsxs)("div",{className:"container pt-5",children:[C&&(0,a.jsxs)(c.Modal,{isOpen:E.modal_static,toggle:K,centered:!0,size:"sm",children:[(0,a.jsxs)(u.ModalHeader,{toggle:K,children:[U("Success"),"!"]}),(0,a.jsx)(_.ModalBody,{children:(0,a.jsx)(o.Row,{children:(0,a.jsxs)(l.Col,{lg:12,children:[(0,a.jsxs)("p",{className:"text-center booking-p",children:[U("ticket_num")," ",M]}),(0,a.jsxs)("p",{className:"text-center booking-p",children:[U("seat"),": ",B]}),V&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("p",{className:"text-center booking-p",children:[U("date"),": ",V.journey_date||V.journeyDate]}),(0,a.jsxs)("p",{className:"text-center booking-p",children:[U("time"),": ",V.departure||V.departure_time]}),(0,a.jsxs)("p",{className:"text-center booking-p",children:[U("to"),": ",V.to_location||V.to]})]})]})})}),(0,a.jsx)(p.ModalFooter,{children:(0,a.jsx)(d.Button,{color:"primary",onClick:K,children:"OK"})})]}),D&&(0,a.jsxs)(c.Modal,{isOpen:T.modal_static,toggle:z,centered:!0,size:"sm",children:[(0,a.jsxs)(u.ModalHeader,{toggle:z,children:[U("Failed"),"!"]}),(0,a.jsx)(_.ModalBody,{children:(0,a.jsx)(o.Row,{children:(0,a.jsx)(l.Col,{lg:12,children:(0,a.jsx)("p",{className:"text-center",children:U("failed_booking")})})})}),(0,a.jsx)(p.ModalFooter,{children:(0,a.jsx)(d.Button,{color:"primary",onClick:z,children:"OK"})})]})]})})})}])}]);