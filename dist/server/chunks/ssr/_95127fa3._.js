module.exports=[8852,a=>{"use strict";let b={src:a.i(18677).default,width:90,height:90,blurWidth:8,blurHeight:8,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAIAAABLbSncAAAAMElEQVR42qXNuwkAIBRD0bf/WkHywaEUOxEbPe0NpPpFvQZJtkkm2UJbAMzF58dpAJnnmIYPWUN+AAAAAElFTkSuQmCC"};a.s(["default",0,b])},81549,a=>a.a(async(b,c)=>{try{var d=a.i(8171),e=a.i(27669),f=a.i(27711),g=a.i(65830),h=a.i(61482),i=a.i(23150),j=a.i(76189),k=a.i(27073),l=a.i(80868),m=a.i(75627),n=a.i(25670),o=a.i(47750),p=a.i(66403),q=a.i(53160),r=a.i(28646),s=a.i(6197),t=a.i(12967),u=a.i(26653),v=b([m,o,s,t]);[m,o,s,t]=v.then?(await v)():v,a.s(["default",0,({modal:a,getModal:b,booking:c,buttonText:v="Pay Now"})=>{let{t:w}=(0,o.useTranslation)();(0,n.useRouter)();let{register:x,reset:y,getValues:z,handleSubmit:A,formState:{errors:B}}=(0,s.useForm)(),[C,D]=(0,e.useState)(!1),{state:E}=(0,p.useStateMachine)({updateBooking:q.updateBooking,updateAction:q.updateAction,updateUser:q.updateUser}),F="4d70631d-397c-4efd-929a-87fcd3a9d162:2a8f415d-d9d2-4834-a573-b12c1375b94c",G="undefined"!=typeof Buffer?Buffer.from(F).toString("base64"):btoa(F),H=new r.default({length:10,dictionary:"alphanum_upper"})();(0,e.useEffect)(()=>{c&&y({data:c})},[c,y]);let I=async()=>{D(!0),z("phoneNumber"),z("name"),z("idCardNo"),z("payerEmail");let a={headers:{"x-api-key":process.env.NEXT_PUBLIC_PAYUNIT_API_KEY||"live_jpKGxzmP3riiu7jmal2zU2FgnjfBE67HMHf3Pb4Z",mode:"live","Content-Type":"application/json",Authorization:"Basic "+G}},b=E?.trip?.trip,c={total_amount:b?.price||100,currency:"XAF",transaction_id:H,return_url:"http://localhost:3000/payunit-return/:transaction_id/:transaction_amount/:transaction_gateway/:transaction_status/:purchaseRef/:currency"};try{let{data:b}=await t.default.post("https://app.payunit.net/api/gateway/initialize",c,a);b?.error&&(m.toast.error(b.message),D(!1))}catch(a){D(!1),t.default.isAxiosError(a)?m.toast.error(a.response?.data?.message||"Payment initialization failed"):m.toast.error("An unexpected error occurred")}},J=E?.trip?.trip;return(0,d.jsx)(d.Fragment,{children:(0,d.jsxs)(h.Modal,{isOpen:a.modal_static,backdrop:"static",centered:!0,size:"lg",children:[(0,d.jsxs)(i.ModalHeader,{toggle:()=>b({modal_static:!1}),children:["Destination: ",J?.to_location||J?.to]}),(0,d.jsx)(j.ModalBody,{children:(0,d.jsxs)("form",{onSubmit:A(I),children:[(0,d.jsxs)(f.Row,{children:[(0,d.jsxs)(g.Col,{lg:6,children:[(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{htmlFor:"name",children:w("name")}),(0,d.jsx)("input",{type:"text",name:"name",id:"name",className:"form-control",...x("name",{required:!0,minLength:6})})]}),B.name&&(0,d.jsx)("p",{style:{color:"red"},children:w("agency_branch_err")})]}),(0,d.jsxs)(g.Col,{lg:6,children:[(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{htmlFor:"idCardNo",children:w("id_card")}),(0,d.jsx)("input",{type:"text",name:"idCardNo",id:"idCardNo",className:"form-control",...x("idCardNo",{required:!0})})]}),B.idCardNo&&(0,d.jsx)("p",{style:{color:"red"},children:w("id_card_err")})]}),(0,d.jsxs)(g.Col,{lg:6,children:[(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{htmlFor:"phoneNumber",children:w("phone")}),(0,d.jsx)("input",{type:"number",name:"phoneNumber",id:"phoneNumber",placeholder:"Valid money transfer number",className:"form-control",...x("phoneNumber",{required:!0,minLength:9,maxLength:12})})]}),B.phoneNumber&&(0,d.jsx)("p",{style:{color:"red"},children:w("phone_err")})]}),(0,d.jsxs)(g.Col,{lg:6,children:[(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{htmlFor:"payerEmail",children:w("email_address")}),(0,d.jsx)("input",{type:"email",name:"payerEmail",id:"payerEmail",className:"form-control",...x("payerEmail",{required:!0})})]}),B.payerEmail&&(0,d.jsx)("p",{style:{color:"red"},children:w("phone_err")})]})]}),(0,d.jsx)(k.ModalFooter,{children:C?(0,d.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",padding:"20px"},children:(0,d.jsx)(u.SpinnerCircular,{color:"#bcc015",size:50,"aria-label":"Loading Spinner","data-testid":"loader"})}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(l.Button,{color:"light",onClick:()=>b({modal_static:!1}),children:w("cancel")}),(0,d.jsx)(l.Button,{type:"submit",color:"primary",children:v})]})})]})})]})})}]),c()}catch(a){c(a)}},!1),82738,a=>a.a(async(b,c)=>{try{var d=a.i(8171),e=a.i(27669),f=a.i(66403),g=a.i(53160),h=a.i(13903),i=a.i(27711),j=a.i(65830),k=a.i(73453),l=a.i(37502),m=a.i(80868),n=a.i(61482),o=a.i(23150),p=a.i(76189),q=a.i(27073),r=a.i(60607),s=a.i(12967),t=a.i(26653),u=a.i(38263),v=a.i(8852),w=a.i(47750),x=a.i(75627),y=a.i(81549),z=b([s,w,x,y]);[s,w,x,y]=z.then?(await z)():z,process.env.NEXT_PUBLIC_SOCKET_URL||process.env.NEXT_PUBLIC_API_URL,a.s(["default",0,()=>{let{t:a}=(0,w.useTranslation)(),[b,c]=(0,e.useState)(!1),[z,A]=(0,e.useState)(!1),[B,C]=(0,e.useState)(""),[D,E]=(0,e.useState)(null),{actions:F,state:G}=(0,f.useStateMachine)({updateSearch:g.updateSearch,updateAction:g.updateAction}),[H,I]=(0,e.useState)([]),[J,K]=(0,e.useState)(!0),L=(0,e.useRef)(null),[M,N]=(0,e.useState)({modal_static:!1}),[O,P]=(0,e.useState)({modal_static:!1}),[Q,R]=(0,e.useState)({modal_static:!1}),S=G?.search,T=S?.journeyDate?(0,r.default)(S.journeyDate).format("MM-DD-YYYY"):"",U="string"==typeof S?.from?S.from:S?.from?.value||"",V="string"==typeof S?.to?S.to:S?.to?.value||"",W=S?.departureTime?(0,r.default)(S.departureTime,"hh:mm A").format("HH:mm a"):"";function X(){c(!1),R({modal_static:!1})}let Y=()=>{A(!1),P({modal_static:!1})},Z=(0,e.useCallback)(async()=>{try{let{data:a}=await s.default.get("api/v1/trips/trip-search",{params:{from:U,to:V,journeyDate:T,departureTime:W}});if(a?.error)x.toast.error(a.message);else if(a.data){let b=Object.values(a.data);I(b),K(!1)}}catch(a){s.default.isAxiosError(a)?x.toast.error(a.message||"Failed to fetch trips"):x.toast.error("An unexpected error occurred"),K(!1)}},[U,V,T,W]);(0,e.useEffect)(()=>{"undefined"!=typeof document&&document.body.setAttribute("style","background: #f1f5f7!important;"),Z()},[Z]);let $=H.filter(a=>a.reserved!==a.seats);return J?(0,d.jsx)(e.default.Fragment,{children:(0,d.jsx)("div",{className:"page-content",children:(0,d.jsx)(l.Container,{fluid:!0,className:"",children:(0,d.jsx)("div",{className:"loader-outer",children:(0,d.jsx)("div",{className:"loader-inner",children:(0,d.jsx)(t.SpinnerCircular,{color:"#bcc014",size:50})})})})})}):(0,d.jsx)(d.Fragment,{children:(0,d.jsx)("section",{className:"trip-search mb-5",children:(0,d.jsxs)("div",{className:"container",children:[(0,d.jsx)("div",{className:"row pt-5 mb-4",children:(0,d.jsx)("div",{className:"col-lg-12",children:$.length>1?(0,d.jsxs)("h6",{children:[$.length," ",a("buses")," ",a("from")," ",U," ",a("to")," ",V]}):(0,d.jsxs)("h6",{children:[$.length," ",a("no_bus")," ",a("from")," ",U," ",a("to")," ",V]})})}),(0,d.jsx)("div",{className:"row",children:(0,d.jsx)("div",{className:"col-lg-12",children:H.map(b=>(0,d.jsx)(h.Card,{children:(0,d.jsx)(k.CardBody,{children:(0,d.jsxs)("div",{className:"row p-2",children:[(0,d.jsx)("div",{className:"col-lg-1",children:(0,d.jsx)("div",{className:"text-center",children:b.agency_logo?(0,d.jsx)(u.default,{src:b.agency_logo,alt:"agency logo",className:"agency_l",width:50,height:50}):(0,d.jsx)(u.default,{src:v.default,alt:"logo",width:50,height:50})})}),(0,d.jsx)("div",{className:"col-lg-1",children:(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)("h5",{children:b.trip_type||"Standard"}),(0,d.jsx)("small",{children:a("category")})]})}),(0,d.jsx)("div",{className:"col-lg-2",children:(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)("h5",{children:b.agency_name}),(0,d.jsx)("small",{children:a("Agency")})]})}),(0,d.jsx)("div",{className:"col-lg-2",children:(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)("h5",{children:b.departure}),(0,d.jsx)("small",{children:a("departure")})]})}),(0,d.jsx)("div",{className:"col-lg-2",children:(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)("h5",{children:b.price}),(0,d.jsx)("small",{children:a("price")})]})}),(0,d.jsx)("div",{className:"col-lg-2",children:(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)("h5",{children:b.seats-b.reserved}),(0,d.jsx)("small",{children:a("available_seats")})]})}),(0,d.jsx)("div",{className:"col-lg-2",children:(0,d.jsx)("div",{className:"text-center",children:b.reserved!==b.seats?(0,d.jsx)(m.Button,{block:!0,color:"primary",onClick:()=>{L.current=b,F.updateAction({trip:L.current}),N({modal_static:!0})},children:a("get_ticket")}):(0,d.jsx)(m.Button,{block:!0,disabled:!0,color:"primary",children:a("sold_out")||"Sold Out"})})})]})})},b.id))})}),(0,d.jsx)(y.default,{getModal:N,modal:M,booking:L.current||void 0,buttonText:a("buy")}),z&&(0,d.jsxs)(n.Modal,{isOpen:O.modal_static,toggle:Y,centered:!0,size:"sm",children:[(0,d.jsxs)(o.ModalHeader,{toggle:Y,children:[a("Success"),"!"]}),(0,d.jsx)(p.ModalBody,{children:(0,d.jsx)(i.Row,{children:(0,d.jsxs)(j.Col,{lg:12,children:[(0,d.jsxs)("p",{className:"text-center",children:[a("ticket_num")," ",B]}),(0,d.jsxs)("p",{className:"text-center",children:[a("seat"),": ",D]})]})})}),(0,d.jsx)(q.ModalFooter,{children:(0,d.jsx)(m.Button,{color:"primary",onClick:Y,children:"OK"})})]}),b&&(0,d.jsxs)(n.Modal,{isOpen:Q.modal_static,toggle:X,centered:!0,size:"sm",children:[(0,d.jsxs)(o.ModalHeader,{toggle:X,children:[a("Failed"),"!"]}),(0,d.jsx)(p.ModalBody,{children:(0,d.jsx)(i.Row,{children:(0,d.jsx)(j.Col,{lg:12,children:(0,d.jsx)("p",{className:"text-center",children:a("failed_booking")})})})}),(0,d.jsx)(q.ModalFooter,{children:(0,d.jsx)(m.Button,{color:"primary",onClick:X,children:"OK"})})]})]})})})}]),c()}catch(a){c(a)}},!1),39107,a=>a.a(async(b,c)=>{try{var d=a.i(79168),e=a.i(27068),f=a.i(32759),g=a.i(39141),h=a.i(6555),i=a.i(82738),j=a.i(9193),k=b([i]);[i]=k.then?(await k)():k;let l=(0,f.hoist)(i,"default"),m=(0,f.hoist)(i,"getStaticProps"),n=(0,f.hoist)(i,"getStaticPaths"),o=(0,f.hoist)(i,"getServerSideProps"),p=(0,f.hoist)(i,"config"),q=(0,f.hoist)(i,"reportWebVitals"),r=(0,f.hoist)(i,"unstable_getStaticProps"),s=(0,f.hoist)(i,"unstable_getStaticPaths"),t=(0,f.hoist)(i,"unstable_getStaticParams"),u=(0,f.hoist)(i,"unstable_getServerProps"),v=(0,f.hoist)(i,"unstable_getServerSideProps"),w=new d.PagesRouteModule({definition:{kind:e.RouteKind.PAGES,page:"/Users/TripSearch",pathname:"/Users/TripSearch",bundlePath:"",filename:""},distDir:"./dist",relativeProjectDir:"",components:{App:h.default,Document:g.default},userland:i}),x=(0,j.getHandler)({srcPage:"/Users/TripSearch",config:p,userland:i,routeModule:w,getStaticPaths:n,getStaticProps:m,getServerSideProps:o});a.s(["config",0,p,"default",0,l,"getServerSideProps",0,o,"getStaticPaths",0,n,"getStaticProps",0,m,"handler",0,x,"reportWebVitals",0,q,"routeModule",0,w,"unstable_getServerProps",0,u,"unstable_getServerSideProps",0,v,"unstable_getStaticParams",0,t,"unstable_getStaticPaths",0,s,"unstable_getStaticProps",0,r]),c()}catch(a){c(a)}},!1)];

//# sourceMappingURL=_95127fa3._.js.map