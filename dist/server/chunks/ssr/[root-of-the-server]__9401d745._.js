module.exports=[89679,a=>a.a(async(b,c)=>{try{let b=await a.y("socket.io-client");a.n(b),c()}catch(a){c(a)}},!0),82599,a=>a.a(async(b,c)=>{try{var d=a.i(8171),e=a.i(61482),f=a.i(23150),g=a.i(76189),h=a.i(27073),i=a.i(80868),j=a.i(47750),k=a.i(66403),l=a.i(53160),m=a.i(26653),n=b([j]);[j]=n.then?(await n)():n,a.s(["default",0,({downloadTicket:a,working:b,modalConfirm:c,setModalConfirm:n,buttonText:o="Download"})=>{let{t:p}=(0,j.useTranslation)(),{state:q}=(0,k.useStateMachine)({updateBooking:l.updateBooking,updateAction:l.updateAction,updateUser:l.updateUser}),r=q?.trip?.trip,s=q?.booking?.booking?.data,t=r?.price?r.price/100*10>500?500:r.price/100*10:0,u=r?.price?r.price/100*10>500?r.price+500:r.price/100*10+r.price:0;return(0,d.jsx)(d.Fragment,{children:(0,d.jsxs)(e.Modal,{isOpen:c.modal_static,backdrop:"static",centered:!0,size:"md",children:[(0,d.jsx)(f.ModalHeader,{toggle:()=>n({modal_static:!1}),children:(0,d.jsxs)("h2",{style:{color:"green",fontWeight:"bold"},children:[p("book_success"),"!"]})}),(0,d.jsxs)(g.ModalBody,{children:[(0,d.jsx)("div",{className:"row",children:(0,d.jsx)("div",{id:"ticket-info",className:"col-md-9 col-lg-6 col-xl-5 mx-auto",children:(0,d.jsxs)("ul",{className:"",children:[(0,d.jsxs)("li",{children:[p("Agency"),": ",(0,d.jsx)("span",{children:r?.agency_name||r?.agencyName})]}),(0,d.jsxs)("li",{children:[p("name"),": ",(0,d.jsx)("span",{children:s?.name})]}),(0,d.jsxs)("li",{children:[p("seat"),": ",(0,d.jsx)("span",{children:s?.seat})]}),(0,d.jsxs)("li",{children:[p("ticket_number"),": ",(0,d.jsx)("span",{children:s?.ticket_number||s?.ticketNumber})]}),(0,d.jsxs)("li",{children:[p("to"),": ",(0,d.jsx)("span",{children:r?.to_location||r?.to})]}),(0,d.jsxs)("li",{children:[p("journey_date"),": ",(0,d.jsx)("span",{children:r?.journey_date||r?.journeyDate})]}),(0,d.jsxs)("li",{children:[p("time"),": ",(0,d.jsx)("span",{children:r?.departure||r?.departure_time})]}),(0,d.jsxs)("li",{children:[p("fare"),": ",(0,d.jsx)("span",{children:r?.price})]}),(0,d.jsxs)("li",{children:[p("booking_fee"),": ",(0,d.jsx)("span",{children:t})]}),(0,d.jsxs)("li",{children:[p("to_pay"),": ",(0,d.jsx)("span",{children:u})]})]})})}),(0,d.jsxs)(h.ModalFooter,{children:[(0,d.jsx)("div",{className:"text-center",children:(0,d.jsxs)("p",{className:"summary-p",children:["Note: ",p("reservation_note")]})}),b?(0,d.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",padding:"20px"},children:(0,d.jsx)(m.SpinnerCircular,{color:"#bcc015",size:50,"aria-label":"Loading Spinner","data-testid":"loader"})}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(i.Button,{color:"light",onClick:()=>n({modal_static:!1}),children:p("cancel")}),(0,d.jsx)(i.Button,{type:"submit",onClick:a,color:"primary",children:o})]})]})]})]})})}]),c()}catch(a){c(a)}},!1),64876,a=>a.a(async(b,c)=>{try{var d=a.i(8171),e=a.i(27669),f=a.i(27711),g=a.i(65830),h=a.i(61482),i=a.i(23150),j=a.i(76189),k=a.i(27073),l=a.i(80868),m=a.i(47750),n=a.i(66403),o=a.i(53160),p=a.i(6197),q=a.i(26653),r=b([m,p]);[m,p]=r.then?(await r)():r,a.s(["default",0,({modal:a,getModal:b,booking:c,showSummary:r,isLoading:s,setIsLoading:t,buttonText:u="Continue"})=>{let{t:v}=(0,m.useTranslation)(),{register:w,reset:x,getValues:y,handleSubmit:z,formState:{errors:A}}=(0,p.useForm)(),{state:B}=(0,n.useStateMachine)({updateBooking:o.updateBooking,updateAction:o.updateAction,updateUser:o.updateUser}),C=async()=>{t(!0),y("phoneNumber"),y("name"),y("idCardNo"),y("payerEmail"),b({modal_static:!1}),r()};(0,e.useEffect)(()=>{c&&x({data:c})},[c,x]);let D=B?.trip?.trip;return(0,d.jsx)(d.Fragment,{children:(0,d.jsxs)(h.Modal,{isOpen:a.modal_static,backdrop:"static",centered:!0,size:"lg",children:[(0,d.jsxs)(i.ModalHeader,{toggle:()=>b({modal_static:!1}),children:["Destination: ",D?.to_location||D?.to]}),(0,d.jsx)(j.ModalBody,{children:(0,d.jsxs)("form",{onSubmit:z(C),children:[(0,d.jsxs)(f.Row,{children:[(0,d.jsxs)(g.Col,{lg:6,children:[(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{htmlFor:"name",children:v("name")}),(0,d.jsx)("input",{type:"text",name:"name",id:"name",className:"form-control",...w("name",{required:!0,minLength:6})})]}),A.name&&(0,d.jsx)("p",{style:{color:"red"},children:v("agency_branch_err")})]}),(0,d.jsxs)(g.Col,{lg:6,children:[(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{htmlFor:"idCardNo",children:v("id_card")}),(0,d.jsx)("input",{type:"text",name:"idCardNo",id:"idCardNo",className:"form-control",...w("idCardNo",{required:!0})})]}),A.idCardNo&&(0,d.jsx)("p",{style:{color:"red"},children:v("id_card_err")})]}),(0,d.jsxs)(g.Col,{lg:6,children:[(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{htmlFor:"phoneNumber",children:v("phone")}),(0,d.jsx)("input",{type:"number",name:"phoneNumber",id:"phoneNumber",className:"form-control",...w("phoneNumber",{required:!0,minLength:9,maxLength:12})})]}),A.phoneNumber&&(0,d.jsx)("p",{style:{color:"red"},children:v("phone_err")})]}),(0,d.jsxs)(g.Col,{lg:6,children:[(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{htmlFor:"payerEmail",children:v("email_address")}),(0,d.jsx)("input",{type:"email",name:"payerEmail",id:"payerEmail",className:"form-control",...w("payerEmail",{required:!0})})]}),A.payerEmail&&(0,d.jsx)("p",{style:{color:"red"},children:v("phone_err")})]})]}),(0,d.jsx)(k.ModalFooter,{children:s?(0,d.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",padding:"20px"},children:(0,d.jsx)(q.SpinnerCircular,{color:"#bcc015",size:50,"aria-label":"Loading Spinner","data-testid":"loader"})}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(l.Button,{color:"light",onClick:()=>b({modal_static:!1}),children:v("cancel")}),(0,d.jsx)(l.Button,{type:"submit",color:"primary",children:u})]})})]})})]})})}]),c()}catch(a){c(a)}},!1),69907,a=>a.a(async(b,c)=>{try{var d=a.i(8171),e=a.i(61482),f=a.i(23150),g=a.i(76189),h=a.i(27073),i=a.i(80868),j=a.i(47750),k=a.i(66403),l=a.i(53160),m=a.i(26653),n=b([j]);[j]=n.then?(await n)():n,a.s(["default",0,({createBooking:a,working:b,modalSummary:c,setWorking:n,setModalSummary:o,buttonText:p="Pay Now"})=>{let{t:q}=(0,j.useTranslation)(),{state:r}=(0,k.useStateMachine)({updateBooking:l.updateBooking,updateAction:l.updateAction,updateUser:l.updateUser}),s=r?.trip?.trip,t=s?.price?s.price/100*10>500?500:s.price/100*10:0,u=s?.price?s.price/100*10>500?s.price+500:s.price/100*10+s.price:0;return(0,d.jsx)(d.Fragment,{children:(0,d.jsxs)(e.Modal,{isOpen:c.modal_static,backdrop:"static",centered:!0,size:"md",children:[(0,d.jsx)(f.ModalHeader,{toggle:()=>o({modal_static:!1}),children:(0,d.jsx)("h3",{children:q("ticket_summary")})}),(0,d.jsxs)(g.ModalBody,{children:[(0,d.jsx)("div",{className:"row",children:(0,d.jsx)("div",{className:"col-md-9 col-lg-6 col-xl-5 mx-auto",children:(0,d.jsxs)("ul",{className:"",children:[(0,d.jsxs)("li",{children:[q("Agency"),": ",(0,d.jsx)("span",{children:s?.agency_name||s?.agencyName})]}),(0,d.jsxs)("li",{children:[q("from"),": ",(0,d.jsx)("span",{children:s?.from_location||s?.from})]}),(0,d.jsxs)("li",{children:[q("to"),": ",(0,d.jsx)("span",{children:s?.to_location||s?.to})]}),(0,d.jsxs)("li",{children:[q("journey_date"),": ",(0,d.jsx)("span",{children:s?.journey_date||s?.journeyDate})]}),(0,d.jsxs)("li",{children:[q("time"),": ",(0,d.jsx)("span",{children:s?.departure||s?.departure_time})]}),(0,d.jsxs)("li",{children:[q("fare"),": ",(0,d.jsx)("span",{children:s?.price})]}),(0,d.jsxs)("li",{children:[q("booking_fee"),": ",(0,d.jsx)("span",{children:t})]}),(0,d.jsxs)("li",{children:[q("to_pay"),": ",(0,d.jsx)("span",{children:u})]})]})})}),(0,d.jsxs)(h.ModalFooter,{children:[(0,d.jsx)("div",{className:"text-center",children:(0,d.jsxs)("p",{className:"summary-p",children:["Note: ",q("reservation_note")]})}),b?(0,d.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",padding:"20px"},children:(0,d.jsx)(m.SpinnerCircular,{color:"#bcc015",size:50,"aria-label":"Loading Spinner","data-testid":"loader"})}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(i.Button,{color:"light",onClick:()=>o({modal_static:!1}),children:q("cancel")}),(0,d.jsx)(i.Button,{type:"submit",onClick:a,color:"primary",children:p})]})]})]})]})})}]),c()}catch(a){c(a)}},!1),59171,(a,b,c)=>{b.exports=a.x("html2canvas",()=>require("html2canvas"))},40741,(a,b,c)=>{b.exports=a.x("jspdf",()=>require("jspdf"))},42794,a=>a.a(async(b,c)=>{try{var d=a.i(8171),e=a.i(27669),f=a.i(47750),g=a.i(66403),h=a.i(53160),i=a.i(27711),j=a.i(65830),k=a.i(37502),l=a.i(80868),m=a.i(89679),n=a.i(60607),o=a.i(12967),p=a.i(75627),q=a.i(26653),r=a.i(82599),s=a.i(64876),t=a.i(69907),u=a.i(59171),v=a.i(40741),w=b([f,m,o,p,r,s,t]);[f,m,o,p,r,s,t]=w.then?(await w)():w;let x=process.env.NEXT_PUBLIC_SOCKET_URL||process.env.NEXT_PUBLIC_API_URL||"https://api.bookontransapp.com";a.s(["default",0,()=>{let{t:a}=(0,f.useTranslation)(),{actions:b,state:c}=(0,g.useStateMachine)({updateSearch:h.updateSearch,updateAction:h.updateAction,updateBooking:h.updateBooking}),[w,y]=(0,e.useState)([]),[z,A]=(0,e.useState)(!0),[B,C]=(0,e.useState)(!1),[D,E]=(0,e.useState)(!1),F=(0,e.useRef)(null),G=(0,e.useRef)(null),[H,I]=(0,e.useState)({modal_static:!1}),[J,K]=(0,e.useState)({modal_static:!1}),[L,M]=(0,e.useState)({modal_static:!1}),N=c?.search,O=N?.journeyDate?(0,n.default)(N.journeyDate).format("MM-DD-YYYY"):"",P="string"==typeof N?.from?N.from:N?.from?.value||"",Q="string"==typeof N?.to?N.to:N?.to?.value||"",R=N?.departureTime?(0,n.default)(N.departureTime,"hh:mm A").format("HH:mm a"):"",S=(0,e.useCallback)(async()=>{try{let{data:a}=await o.default.get("api/v1/trips/trip-search",{params:{from:P,to:Q,journeyDate:O,departureTime:R}});if(a?.error)p.toast.error(a.message);else if(a.data){let b=Object.values(a.data);y(b),A(!1)}}catch(a){o.default.isAxiosError(a)?p.toast.error(a.message||"Failed to fetch trips"):p.toast.error("An unexpected error occurred"),A(!1)}},[P,Q,O,R]);(0,e.useEffect)(()=>{let a=(0,m.io)(x);return a.on("trip:update",()=>{S()}),S(),()=>{a.disconnect()}},[S]);let T=async()=>{if(E(!0),C(!0),!F.current){p.toast.error("No trip selected"),E(!1);return}let a=F.current,d={phone_number:null,number_of_seats:"1",ticket_type:"One-way",name:"",id_card_no:null,payer_email:null,trip_id:a.id,agency_name:a.agency_name,agency_id:a.agency_id,journey_date:a.journey_date,price:a.price,departure_city:a.from_location,arrival_city:a.to_location,departure_time:a.departure};try{if(c?.user?.data?.data?.email){let{data:c}=await o.default.post(`api/v1/bookings/create-booking/${a.id}`,d);c?.error?(p.toast.error(c.message),E(!1)):c.data&&(b.updateBooking({booking:c.data}),E(!1),K({modal_static:!1}),M({modal_static:!0}))}else{let{data:c}=await o.default.post(`api/v1/bookings/anon-booking/${a.id}`,d);c?.error?(p.toast.error(c.message),C(!1),E(!1)):c.data&&(G.current=c.data,b.updateBooking({booking:G.current}),E(!1),K({modal_static:!1}),M({modal_static:!0}),I({modal_static:!1}),S())}}catch(a){o.default.isAxiosError(a)?p.toast.error(a.response?.data?.message||"Failed to create booking"):p.toast.error("An unexpected error occurred"),E(!1),C(!1)}},U=w.filter(a=>a.reserved!==a.seats);return z?(0,d.jsx)(e.default.Fragment,{children:(0,d.jsx)("div",{className:"page-content",children:(0,d.jsx)(k.Container,{fluid:!0,className:"",children:(0,d.jsx)("div",{className:"loader-outer",children:(0,d.jsx)("div",{className:"loader-inner",children:(0,d.jsx)(q.SpinnerCircular,{color:"#bcc014",size:50})})})})})}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("section",{className:"trip-search mb-5",children:[(0,d.jsx)("div",{className:"container-fluid",children:(0,d.jsx)("div",{className:"row pt-5",children:(0,d.jsx)("div",{className:"col-lg-2",children:U.length>1?(0,d.jsxs)("h6",{children:[U.length," ",a("buses")," ",a("from")," ",P," ",a("to")," ",Q]}):(0,d.jsxs)("h6",{children:[U.length," ",a("no_bus")," ",a("from")," ",P," ",a("to")," ",Q]})})})}),(0,d.jsx)(k.Container,{className:"",fluid:!0,children:(0,d.jsx)(i.Row,{className:"pt-3 mr-lg-3 d-flex justify-content-lg-center align-items-lg-center justify-content-center align-items-center text-center",children:w.map(c=>(0,d.jsxs)(j.Col,{lg:5,className:"trip-wrap ml-lg-3 mb-4",children:[(0,d.jsxs)(i.Row,{className:"text-center",children:[(0,d.jsx)(j.Col,{md:6,className:"mb-3",children:(0,d.jsxs)("span",{className:"price-label",children:[a("price"),": ",c.price," XAF"]})}),(0,d.jsx)(j.Col,{md:6,className:"mb-3",children:(0,d.jsxs)("h1",{children:[c.from_location||c.from," - ",c.to_location||c.to]})})]}),(0,d.jsxs)(i.Row,{className:"pt-2 text-center pb-5 pr-lg-5 detail-row",children:[(0,d.jsxs)(j.Col,{md:6,className:"mb-3",children:[c.agency_logo&&(0,d.jsx)("img",{src:c.agency_logo,alt:"agency logo",className:"",style:{width:"200px",borderRadius:"100px"}}),(0,d.jsx)("h3",{children:c.agency_name})]}),(0,d.jsxs)(j.Col,{md:6,className:"mb-3",children:[(0,d.jsxs)(i.Row,{className:"gray-background",children:[(0,d.jsx)(j.Col,{md:4,children:(0,d.jsxs)("span",{className:"gray-background-text",children:[a("available_seats"),": ",c.seats-c.reserved]})}),(0,d.jsx)(j.Col,{md:4,children:(0,d.jsxs)("span",{className:"gray-background-text",children:[a("category"),": ",c.trip_type||"Standard"]})})]}),(0,d.jsxs)(i.Row,{className:"gray-background mt-4",children:[(0,d.jsxs)(j.Col,{md:4,children:[(0,d.jsx)("div",{className:"gray-background-text",children:a("departure")}),(0,d.jsx)("span",{className:"gray-background-text",children:c.departure})]}),(0,d.jsxs)(j.Col,{md:4,children:[(0,d.jsx)("div",{className:"gray-background-text",children:a("arrival")}),(0,d.jsx)("span",{className:"gray-background-text",children:c.arrival})]})]}),(0,d.jsx)(i.Row,{className:"mt-4",children:(0,d.jsx)(j.Col,{md:12,children:(0,d.jsx)("div",{className:"text-center",children:c.reserved!==c.seats?(0,d.jsx)(l.Button,{block:!0,color:"primary",onClick:()=>{F.current=c,b.updateAction({trip:F.current}),I({modal_static:!0})},children:a("reserve_ticket")}):(0,d.jsx)(l.Button,{block:!0,disabled:!0,color:"primary",children:a("sold_out")||"Sold Out"})})})})]})]})]},c.id))})})]}),(0,d.jsx)(s.default,{isLoading:B,setIsLoading:C,getModal:I,modal:H,booking:F.current||void 0,showSummary:()=>{C(!1),K({modal_static:!0})},buttonText:a("next")}),(0,d.jsx)(t.default,{createBooking:T,working:D,modalSummary:J,setWorking:E,setModalSummary:K,buttonText:a("pay_now")}),(0,d.jsx)(r.default,{downloadTicket:()=>{let a=document.getElementById("ticket-info");a&&((0,u.default)(a,{logging:!0,letterRendering:1,useCORS:!0}).then(a=>{let b=a.toDataURL("image/png"),c=new v.default({format:"a4",unit:"mm"});c.addImage(b,"PNG",0,0,210,297),c.save("ticket.pdf")}),M({modal_static:!1}),E(!1))},working:D,modalConfirm:L,setModalConfirm:M,buttonText:a("download_ticket")})]})}]),c()}catch(a){c(a)}},!1),58532,a=>a.a(async(b,c)=>{try{var d=a.i(79168),e=a.i(27068),f=a.i(32759),g=a.i(39141),h=a.i(6555),i=a.i(42794),j=a.i(9193),k=b([i]);[i]=k.then?(await k)():k;let l=(0,f.hoist)(i,"default"),m=(0,f.hoist)(i,"getStaticProps"),n=(0,f.hoist)(i,"getStaticPaths"),o=(0,f.hoist)(i,"getServerSideProps"),p=(0,f.hoist)(i,"config"),q=(0,f.hoist)(i,"reportWebVitals"),r=(0,f.hoist)(i,"unstable_getStaticProps"),s=(0,f.hoist)(i,"unstable_getStaticPaths"),t=(0,f.hoist)(i,"unstable_getStaticParams"),u=(0,f.hoist)(i,"unstable_getServerProps"),v=(0,f.hoist)(i,"unstable_getServerSideProps"),w=new d.PagesRouteModule({definition:{kind:e.RouteKind.PAGES,page:"/Users/SearchResults",pathname:"/Users/SearchResults",bundlePath:"",filename:""},distDir:"./dist",relativeProjectDir:"",components:{App:h.default,Document:g.default},userland:i}),x=(0,j.getHandler)({srcPage:"/Users/SearchResults",config:p,userland:i,routeModule:w,getStaticPaths:n,getStaticProps:m,getServerSideProps:o});a.s(["config",0,p,"default",0,l,"getServerSideProps",0,o,"getStaticPaths",0,n,"getStaticProps",0,m,"handler",0,x,"reportWebVitals",0,q,"routeModule",0,w,"unstable_getServerProps",0,u,"unstable_getServerSideProps",0,v,"unstable_getStaticParams",0,t,"unstable_getStaticPaths",0,s,"unstable_getStaticProps",0,r]),c()}catch(a){c(a)}},!1)];

//# sourceMappingURL=%5Broot-of-the-server%5D__9401d745._.js.map