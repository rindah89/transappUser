(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,89129,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a={DecodeError:function(){return x},MiddlewareNotFoundError:function(){return v},MissingStaticPage:function(){return b},NormalizeError:function(){return j},PageNotFoundError:function(){return y},SP:function(){return f},ST:function(){return g},WEB_VITALS:function(){return l},execOnce:function(){return i},getDisplayName:function(){return u},getLocationOrigin:function(){return c},getURL:function(){return d},isAbsoluteUrl:function(){return o},isResSent:function(){return m},loadGetInitialProps:function(){return p},normalizeRepeatedSlashes:function(){return h},stringifyError:function(){return N}};for(var n in a)Object.defineProperty(r,n,{enumerable:!0,get:a[n]});let l=["CLS","FCP","FID","INP","LCP","TTFB"];function i(e){let t,r=!1;return function(){for(var a=arguments.length,n=Array(a),l=0;l<a;l++)n[l]=arguments[l];return r||(r=!0,t=e(...n)),t}}let s=/^[a-zA-Z][a-zA-Z\d+\-.]*?:/,o=e=>s.test(e);function c(){let{protocol:e,hostname:t,port:r}=window.location;return"".concat(e,"//").concat(t).concat(r?":"+r:"")}function d(){let{href:e}=window.location,t=c();return e.substring(t.length)}function u(e){return"string"==typeof e?e:e.displayName||e.name||"Unknown"}function m(e){return e.finished||e.headersSent}function h(e){let t=e.split("?");return t[0].replace(/\\/g,"/").replace(/\/\/+/g,"/")+(t[1]?"?".concat(t.slice(1).join("?")):"")}async function p(e,t){let r=t.res||t.ctx&&t.ctx.res;if(!e.getInitialProps)return t.ctx&&t.Component?{pageProps:await p(t.Component,t.ctx)}:{};let a=await e.getInitialProps(t);if(r&&m(r))return a;if(!a)throw Object.defineProperty(Error('"'.concat(u(e),'.getInitialProps()" should resolve to an object. But found "').concat(a,'" instead.')),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return a}let f="undefined"!=typeof performance,g=f&&["mark","measure","getEntriesByName"].every(e=>"function"==typeof performance[e]);class x extends Error{}class j extends Error{}class y extends Error{constructor(e){super(),this.code="ENOENT",this.name="PageNotFoundError",this.message="Cannot find module for page: ".concat(e)}}class b extends Error{constructor(e,t){super(),this.message="Failed to load static file for page: ".concat(e," ").concat(t)}}class v extends Error{constructor(){super(),this.code="ENOENT",this.message="Cannot find the middleware module"}}function N(e){return JSON.stringify({message:e.message,stack:e.stack})}},18677,e=>{e.v("/_next/static/media/client-2.9b8cfb13.png")},3404,89248,e=>{"use strict";var t=e.i(91788),r=e.i(91567),a=e.i(72043),n=e.i(74761),l=["className","cssModule","color","body","inverse","outline","tag","innerRef"];function i(){return(i=Object.assign.bind()).apply(this,arguments)}function s(e){var r=e.className,s=e.cssModule,o=e.color,c=e.body,d=e.inverse,u=e.outline,m=e.tag,h=e.innerRef,p=function(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},l=Object.keys(e);for(a=0;a<l.length;a++)r=l[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)r=l[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}(e,l),f=(0,n.mapToCssModules)((0,a.default)(r,"card",!!d&&"text-white",!!c&&"card-body",!!o&&"".concat(u?"border":"bg","-").concat(o)),s);return t.default.createElement(void 0===m?"div":m,i({},p,{className:f,ref:h}))}s.propTypes={body:r.default.bool,className:r.default.string,color:r.default.string,cssModule:r.default.object,innerRef:r.default.oneOfType([r.default.object,r.default.string,r.default.func]),inverse:r.default.bool,outline:r.default.bool,tag:n.tagPropType},e.s(["Card",0,s],3404);var o=["className","cssModule","innerRef","tag"];function c(){return(c=Object.assign.bind()).apply(this,arguments)}function d(e){var r=e.className,l=e.cssModule,i=e.innerRef,s=e.tag,d=function(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},l=Object.keys(e);for(a=0;a<l.length;a++)r=l[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)r=l[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}(e,o),u=(0,n.mapToCssModules)((0,a.default)(r,"card-body"),l);return t.default.createElement(void 0===s?"div":s,c({},d,{className:u,ref:i}))}d.propTypes={className:r.default.string,cssModule:r.default.object,innerRef:r.default.oneOfType([r.default.object,r.default.string,r.default.func]),tag:n.tagPropType},e.s(["CardBody",0,d],89248)},3070,e=>{"use strict";var t=e.i(50461),r=e.i(91398),a=e.i(91788),n=e.i(58393),l=e.i(51642),i=e.i(3404),s=e.i(13169),o=e.i(47317),c=e.i(89248),d=e.i(96648),u=e.i(50360),m=e.i(40085),h=e.i(95035),p=e.i(44343),f=e.i(66175),g=e.i(99523),x=e.i(30559),j=e.i(38172),y=e.i(26019);let b={src:e.i(18677).default,width:90,height:90,blurWidth:8,blurHeight:8,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAIAAABLbSncAAAAMElEQVR42qXNuwkAIBRD0bf/WkHywaEUOxEbPe0NpPpFvQZJtkkm2UJbAMzF58dpAJnnmIYPWUN+AAAAAElFTkSuQmCC"};e.i(47620);var v=e.i(71179),N=e.i(7982),_=e.i(21168),A=e.i(64022),E=e.i(17837),S=e.i(89915),C=e.i(58021);let O=e=>{var i;let{modal:c,getModal:d,booking:g,buttonText:y="Pay Now"}=e,{t:b}=(0,v.useTranslation)();(0,E.useRouter)();let{register:O,reset:w,getValues:P,handleSubmit:T,formState:{errors:M}}=(0,C.useForm)(),[k,B]=(0,a.useState)(!1),{state:F}=(0,n.useStateMachine)({updateBooking:l.updateBooking,updateAction:l.updateAction,updateUser:l.updateUser}),I="".concat("4d70631d-397c-4efd-929a-87fcd3a9d162",":").concat("2a8f415d-d9d2-4834-a573-b12c1375b94c"),R=void 0!==_.Buffer?_.Buffer.from(I).toString("base64"):btoa(I),U=new S.default({length:10,dictionary:"alphanum_upper"})();(0,a.useEffect)(()=>{g&&w({data:g})},[g,w]);let L=async()=>{var e,r,a;B(!0);let n=P("phoneNumber"),l=P("name"),i=P("idCardNo"),s=P("payerEmail");localStorage.setItem("phoneNumber",n),localStorage.setItem("name",l),localStorage.setItem("idCard",i),localStorage.setItem("email",s),localStorage.setItem("transactionID",U);let o={headers:{"x-api-key":t.default.env.NEXT_PUBLIC_PAYUNIT_API_KEY||"live_jpKGxzmP3riiu7jmal2zU2FgnjfBE67HMHf3Pb4Z",mode:"live","Content-Type":"application/json",Authorization:"Basic "+R}},c=null==(e=null==F?void 0:F.trip)?void 0:e.trip,d={total_amount:(null==c?void 0:c.price)||100,currency:"XAF",transaction_id:U,return_url:"".concat("http://localhost:3000","/payunit-return/:transaction_id/:transaction_amount/:transaction_gateway/:transaction_status/:purchaseRef/:currency")};try{let{data:e}=await x.default.post("https://app.payunit.net/api/gateway/initialize",d,o);(null==e?void 0:e.error)?(N.toast.error(e.message),B(!1)):"SUCCESS"===e.status&&(window.location.href=e.data.transaction_url)}catch(e){B(!1),x.default.isAxiosError(e)?N.toast.error((null==(a=e.response)||null==(r=a.data)?void 0:r.message)||"Payment initialization failed"):N.toast.error("An unexpected error occurred")}},z=null==(i=null==F?void 0:F.trip)?void 0:i.trip;return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(m.Modal,{isOpen:c.modal_static,backdrop:"static",centered:!0,size:"lg",children:[(0,r.jsxs)(h.ModalHeader,{toggle:()=>d({modal_static:!1}),children:["Destination: ",(null==z?void 0:z.to_location)||(null==z?void 0:z.to)]}),(0,r.jsx)(p.ModalBody,{children:(0,r.jsxs)("form",{onSubmit:T(L),children:[(0,r.jsxs)(s.Row,{children:[(0,r.jsxs)(o.Col,{lg:6,children:[(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{htmlFor:"name",children:b("name")}),(0,r.jsx)("input",(0,A._)({type:"text",name:"name",id:"name",className:"form-control"},O("name",{required:!0,minLength:6})))]}),M.name&&(0,r.jsx)("p",{style:{color:"red"},children:b("agency_branch_err")})]}),(0,r.jsxs)(o.Col,{lg:6,children:[(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{htmlFor:"idCardNo",children:b("id_card")}),(0,r.jsx)("input",(0,A._)({type:"text",name:"idCardNo",id:"idCardNo",className:"form-control"},O("idCardNo",{required:!0})))]}),M.idCardNo&&(0,r.jsx)("p",{style:{color:"red"},children:b("id_card_err")})]}),(0,r.jsxs)(o.Col,{lg:6,children:[(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{htmlFor:"phoneNumber",children:b("phone")}),(0,r.jsx)("input",(0,A._)({type:"number",name:"phoneNumber",id:"phoneNumber",placeholder:"Valid money transfer number",className:"form-control"},O("phoneNumber",{required:!0,minLength:9,maxLength:12})))]}),M.phoneNumber&&(0,r.jsx)("p",{style:{color:"red"},children:b("phone_err")})]}),(0,r.jsxs)(o.Col,{lg:6,children:[(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{htmlFor:"payerEmail",children:b("email_address")}),(0,r.jsx)("input",(0,A._)({type:"email",name:"payerEmail",id:"payerEmail",className:"form-control"},O("payerEmail",{required:!0})))]}),M.payerEmail&&(0,r.jsx)("p",{style:{color:"red"},children:b("phone_err")})]})]}),(0,r.jsx)(f.ModalFooter,{children:k?(0,r.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",padding:"20px"},children:(0,r.jsx)(j.SpinnerCircular,{color:"#bcc015",size:50,"aria-label":"Loading Spinner","data-testid":"loader"})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.Button,{color:"light",onClick:()=>d({modal_static:!1}),children:b("cancel")}),(0,r.jsx)(u.Button,{type:"submit",color:"primary",children:y})]})})]})})]})})};t.default.env.NEXT_PUBLIC_SOCKET_URL||t.default.env.NEXT_PUBLIC_API_URL,e.s(["default",0,()=>{var e,t;let{t:_}=(0,v.useTranslation)(),[A,E]=(0,a.useState)(!1),[S,C]=(0,a.useState)(!1),[w,P]=(0,a.useState)(""),[T,M]=(0,a.useState)(null),{actions:k,state:B}=(0,n.useStateMachine)({updateSearch:l.updateSearch,updateAction:l.updateAction}),[F,I]=(0,a.useState)([]),[R,U]=(0,a.useState)(!0),L=(0,a.useRef)(null),[z,D]=(0,a.useState)({modal_static:!1}),[H,X]=(0,a.useState)({modal_static:!1}),[K,Y]=(0,a.useState)({modal_static:!1}),q=null==B?void 0:B.search,J=(null==q?void 0:q.journeyDate)?(0,g.default)(q.journeyDate).format("MM-DD-YYYY"):"",V="string"==typeof(null==q?void 0:q.from)?q.from:(null==(e=null==q?void 0:q.from)?void 0:e.value)||"",W="string"==typeof(null==q?void 0:q.to)?q.to:(null==(t=null==q?void 0:q.to)?void 0:t.value)||"",Z=(null==q?void 0:q.departureTime)?(0,g.default)(q.departureTime,"hh:mm A").format("HH:mm a"):"";function G(){E(!1),Y({modal_static:!1})}let Q=()=>{C(!1),X({modal_static:!1})},$=(0,a.useCallback)(async()=>{try{let{data:e}=await x.default.get("api/v1/trips/trip-search",{params:{from:V,to:W,journeyDate:J,departureTime:Z}});if(null==e?void 0:e.error)N.toast.error(e.message);else if(e.data){let t=Object.values(e.data);I(t),U(!1)}}catch(e){x.default.isAxiosError(e)?N.toast.error(e.message||"Failed to fetch trips"):N.toast.error("An unexpected error occurred"),U(!1)}},[V,W,J,Z]);(0,a.useEffect)(()=>{"undefined"!=typeof document&&document.body.setAttribute("style","background: #f1f5f7!important;"),$()},[$]);let ee=F.filter(e=>e.reserved!==e.seats);return R?(0,r.jsx)(a.default.Fragment,{children:(0,r.jsx)("div",{className:"page-content",children:(0,r.jsx)(d.Container,{fluid:!0,className:"",children:(0,r.jsx)("div",{className:"loader-outer",children:(0,r.jsx)("div",{className:"loader-inner",children:(0,r.jsx)(j.SpinnerCircular,{color:"#bcc014",size:50})})})})})}):(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("section",{className:"trip-search mb-5",children:(0,r.jsxs)("div",{className:"container",children:[(0,r.jsx)("div",{className:"row pt-5 mb-4",children:(0,r.jsx)("div",{className:"col-lg-12",children:ee.length>1?(0,r.jsxs)("h6",{children:[ee.length," ",_("buses")," ",_("from")," ",V," ",_("to")," ",W]}):(0,r.jsxs)("h6",{children:[ee.length," ",_("no_bus")," ",_("from")," ",V," ",_("to")," ",W]})})}),(0,r.jsx)("div",{className:"row",children:(0,r.jsx)("div",{className:"col-lg-12",children:F.map(e=>(0,r.jsx)(i.Card,{children:(0,r.jsx)(c.CardBody,{children:(0,r.jsxs)("div",{className:"row p-2",children:[(0,r.jsx)("div",{className:"col-lg-1",children:(0,r.jsx)("div",{className:"text-center",children:e.agency_logo?(0,r.jsx)(y.default,{src:e.agency_logo,alt:"agency logo",className:"agency_l",width:50,height:50}):(0,r.jsx)(y.default,{src:b,alt:"logo",width:50,height:50})})}),(0,r.jsx)("div",{className:"col-lg-1",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h5",{children:e.trip_type||"Standard"}),(0,r.jsx)("small",{children:_("category")})]})}),(0,r.jsx)("div",{className:"col-lg-2",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h5",{children:e.agency_name}),(0,r.jsx)("small",{children:_("Agency")})]})}),(0,r.jsx)("div",{className:"col-lg-2",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h5",{children:e.departure}),(0,r.jsx)("small",{children:_("departure")})]})}),(0,r.jsx)("div",{className:"col-lg-2",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h5",{children:e.price}),(0,r.jsx)("small",{children:_("price")})]})}),(0,r.jsx)("div",{className:"col-lg-2",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h5",{children:e.seats-e.reserved}),(0,r.jsx)("small",{children:_("available_seats")})]})}),(0,r.jsx)("div",{className:"col-lg-2",children:(0,r.jsx)("div",{className:"text-center",children:e.reserved!==e.seats?(0,r.jsx)(u.Button,{block:!0,color:"primary",onClick:()=>{L.current=e,k.updateAction({trip:L.current}),D({modal_static:!0})},children:_("get_ticket")}):(0,r.jsx)(u.Button,{block:!0,disabled:!0,color:"primary",children:_("sold_out")||"Sold Out"})})})]})})},e.id))})}),(0,r.jsx)(O,{getModal:D,modal:z,booking:L.current||void 0,buttonText:_("buy")}),S&&(0,r.jsxs)(m.Modal,{isOpen:H.modal_static,toggle:Q,centered:!0,size:"sm",children:[(0,r.jsxs)(h.ModalHeader,{toggle:Q,children:[_("Success"),"!"]}),(0,r.jsx)(p.ModalBody,{children:(0,r.jsx)(s.Row,{children:(0,r.jsxs)(o.Col,{lg:12,children:[(0,r.jsxs)("p",{className:"text-center",children:[_("ticket_num")," ",w]}),(0,r.jsxs)("p",{className:"text-center",children:[_("seat"),": ",T]})]})})}),(0,r.jsx)(f.ModalFooter,{children:(0,r.jsx)(u.Button,{color:"primary",onClick:Q,children:"OK"})})]}),A&&(0,r.jsxs)(m.Modal,{isOpen:K.modal_static,toggle:G,centered:!0,size:"sm",children:[(0,r.jsxs)(h.ModalHeader,{toggle:G,children:[_("Failed"),"!"]}),(0,r.jsx)(p.ModalBody,{children:(0,r.jsx)(s.Row,{children:(0,r.jsx)(o.Col,{lg:12,children:(0,r.jsx)("p",{className:"text-center",children:_("failed_booking")})})})}),(0,r.jsx)(f.ModalFooter,{children:(0,r.jsx)(u.Button,{color:"primary",onClick:G,children:"OK"})})]})]})})})}],3070)},31383,(e,t,r)=>{let a="/Users/TripSearch";(window.__NEXT_P=window.__NEXT_P||[]).push([a,()=>e.r(3070)]),t.hot&&t.hot.dispose(function(){window.__NEXT_P.push([a])})},48761,e=>{e.v(t=>Promise.all(["static/chunks/6edfcc483de69d24.js"].map(t=>e.l(t))).then(()=>t(93594)))},28805,e=>{e.v(t=>Promise.all(["static/chunks/8e51f3ba5c97b86e.js"].map(t=>e.l(t))).then(()=>t(79466)))}]);